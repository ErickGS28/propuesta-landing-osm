(()=>{const e=document.createElement("style");e.innerHTML=".hide-content { opacity: 0; }",document.head.appendChild(e),document.documentElement.classList.add("hide-content");const t=()=>{document.documentElement.classList.remove("hide-content")},n=new URLSearchParams(window.location.search);let o=n.get("tofu_slug")||window.tofuConfig?.tofu_slug;o=o?.replace(/\/$/,"");const i=window.tofuConfig?.tofu_content_id;let r=n.get("tofu_content_id")||i;o||r||t(),window.location.hostname.includes("tractian.com")&&o&&r&&function(){console.log("[tofu_embed] Immediately hiding content with display:none");const e=document.createElement("style");e.id="tofu-hide-content-style",e.innerHTML="\n      html, body {\n        display: none !important;\n      }\n    ",document.head.appendChild(e);const t=()=>{console.log("[tofu_embed] Showing content with smooth transition"),e.innerHTML="\n        html, body {\n          opacity: 1 !important;\n          transition: opacity 0.3s ease-in-out;\n        }\n      ",setTimeout((()=>{console.log("[tofu_embed] Removing hide-content style completely"),e.remove()}),500)};requestAnimationFrame((()=>{console.log("[tofu_embed] Switching to opacity-based hiding"),e.innerHTML="\n        html, body {\n          opacity: 0 !important;\n          transition: opacity 0.3s ease-in-out;\n        }\n      ",setTimeout(t,1e3)}))}();let a=n.get("tofu_variation")||window.tofuConfig?.tofu_variation;const c=new URLSearchParams;r&&c.append("tofu_content_id",r),o&&c.append("tofu_slug",o),a&&c.append("tofu_variation",a);const s=n.get("debug_ip_address");s&&c.append("debug_ip_address",s);const d=`https://api.tofuhq.com/api/public/components/?${c.toString()}`,l=e=>e.replace(/\s/g,"").toLowerCase(),u=[],h=(e,t)=>{const n=`${e.href}_${e.textContent}`;if(u.length>0&&u.includes(n))return;const o=((e,t)=>Array.from(document?.querySelectorAll(e)).filter((e=>e.href===t.href&&e.innerText===t.text)))(e.tagName,e);o.length>0&&(o[t.index].href=t.href,o[t.index].textContent=t.text,u.push(n))},m=(e,t)=>{e.nodeType!==Node.ELEMENT_NODE||["SCRIPT","STYLE","NOSCRIPT"].includes(e.tagName)||e.childNodes.forEach((n=>{if(n.nodeType===Node.TEXT_NODE&&""!==n.textContent.trim()){const n=l(e.textContent);t.texts[n]&&(e.innerHTML=t.texts[n])}else if(n.nodeType===Node.ELEMENT_NODE){if("A"===n.tagName&&n.href){const e=`${n.href}_${n.textContent}`;if(t.links[e]){const o=t.links[e];null!==o.index?h(n,o):(n.href=o.href,n.textContent=o.text)}}m(n,t)}}))},f=e=>e.split("/").pop().split("?")[0].split("#")[0],g=(e,t)=>{if(e.nodeType===Node.ELEMENT_NODE)if("IMG"===e.tagName){const n=f(e.src),o=Object.keys(t).find((e=>f(e)===n));if(o){const n=t[o];if(!n.url)return;const i=document.createElement("img");Array.from(e.attributes).forEach((e=>{i.setAttribute(e.name,e.value)})),i.src=n.url,i.srcset=e.srcset?n.url:"",i.alt=n.alt??e.alt,i.width=n.width??e.width,i.height=n.height??e.height,i.loading=n.loading??e.loading,i.style.objectFit="contain",e.parentNode.replaceChild(i,e)}}else e.childNodes.forEach((e=>g(e,t)))},p=crypto.randomUUID(),_=e=>{if(i&&!o||!r)return;const t=(e=>(o||(o=e?.tofu_slug),{session_id:p,tofu_slug:o,tofu_variation:a,user_agent:navigator.userAgent,payload:{full_url:window.location.href,referrer:document.referrer}}))(e);fetch(`https://api.tofuhq.com/api/public/analytics/page_view/?tofu_content_id=${r}`,{method:"POST",body:JSON.stringify({...t}),headers:{"Content-Type":"application/json"}}).then((e=>e.json())).catch((e=>console.error("Error registering page view:",e)))};function y(){if(!r)return;if(i&&!o)return t();let e;fetch(d).then((e=>e.json())).catch((e=>console.error("Error fetching content:",e))).then((t=>{e=t?.meta||{};const n=(e=>{const t={},n={},o={};return Object.entries(e).forEach((([,e])=>{e.original_text&&(t[l(e.original_text)]=e.text.replace(/\n/g,"<br>")),e.original_image&&e.image&&(n[e.original_image.url]=e.image),e.original_link&&e.link&&(o[`${e.original_link.href}_${e.original_link.text}`]={href:e.link.href,text:e.link.text,index:e.meta.html_tag_index})})),{texts:t,images:n,links:o}})(t);m(document.body,n),Object.keys(n.images).length>0&&g(document.body,n.images)})).catch((e=>{console.error("Error processing Tofu data:",e),t()})).finally((()=>{t(),setTimeout((()=>{_(e),window.addEventListener("beforeunload",(()=>{_(e)}))}),500)}))}document.addEventListener("DOMContentLoaded",y),"complete"!==document.readyState&&"interactive"!==document.readyState||y()})();