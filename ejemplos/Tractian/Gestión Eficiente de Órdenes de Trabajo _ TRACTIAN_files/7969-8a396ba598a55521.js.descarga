(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7969],{96603:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},27740:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CroctProvider=t.CroctContext=void 0;let n=r(57437),i=r(2265),o=r(3124);t.CroctContext=(0,i.createContext)(null),t.CroctContext.displayName="CroctContext",t.CroctProvider=e=>{let{children:r,...s}=e,a=(0,i.useContext)(t.CroctContext),u=function(e){let t=(0,i.useRef)(e);return t.current=e,t}(s);if(null!==a)throw Error("You cannot render <CroctProvider> inside another <CroctProvider>. Croct should only be initialized once in the application.");let c=(0,i.useMemo)(()=>({get plug(){return o.croct.initialized||o.croct.plug(u.current),new Proxy(o.croct,{get:function(e,t){return"plug"===t?t=>{e.plug({...u.current,...t})}:e[t]}})}}),[u]);return(0,i.useEffect)(()=>(o.croct.plug(u.current),()=>{o.croct.unplug().catch(()=>{})}),[u]),(0,n.jsx)(t.CroctContext.Provider,{value:c,children:r})}},50789:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Personalization=function(e){let{query:t,children:r,...s}=e,a=(0,o.useEvaluation)(t,s);return(0,n.jsx)(i.Fragment,{children:r(a)})};let n=r(57437),i=r(2265),o=r(73377)},92020:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Slot=void 0;let n=r(57437),i=r(2265),o=r(73377);t.Slot=e=>{let{id:t,children:r,...s}=e,a=(0,o.useContent)(t,s);return(0,n.jsx)(i.Fragment,{children:r(a)})}},10596:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),i(r(50789),t),i(r(92020),t)},76787:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.hash=function(e){let t=0;for(let r of e){let e=r.charCodeAt(0);t=(t<<5)-t+e|0}return t.toString(16)}},14754:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Cache=void 0;class Cache{constructor(e){this.cache={},this.defaultExpiration=e}load(e){let{cacheKey:t,loader:r,fallback:n,expiration:i=this.defaultExpiration}=e,o=this.get(t);if(void 0!==o){if(void 0!==o.error){if(void 0!==n)return n;throw o.error}if(void 0!==o.result)return o.result;throw o.promise}let s={dispose:()=>{void 0!==s.timeout||i<0||(s.timeout=window.setTimeout(()=>{delete this.cache[t]},i))},promise:r().then(e=>(s.result=e,e)).catch(e=>{s.error=e}).finally(()=>{s.dispose()})};throw this.cache[t]=s,s.promise}get(e){let t=this.cache[e];if(void 0!==t)return void 0!==t.timeout&&(clearTimeout(t.timeout),delete t.timeout,t.dispose()),t}}t.Cache=Cache},73377:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),i(r(75136),t),i(r(74715),t),i(r(19683),t)},74715:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useContent=void 0;let n=r(2265),i=r(34537),o=r(19683),s=r(3124),a=r(76787);t.useContent=(0,s.isSsr)()?function(e,{initial:t}={}){if(void 0===t)throw Error("The initial content is required for server-side rendering (SSR). For help, see https://croct.help/sdk/react/missing-slot-content");return t}:function(e,t={}){var r;let{fallback:s,cacheKey:u,expiration:c,initial:l,staleWhileLoading:d=!1,...h}=t,[p,f]=(0,n.useState)(l),{preferredLocale:g}=h,y=(0,o.useCroct)(),m=(0,i.useLoader)({cacheKey:(0,a.hash)(`useContent:${null!=u?u:""}:${e}:${null!=g?g:""}:${JSON.stringify(null!==(r=h.attributes)&&void 0!==r?r:{})}`),loader:()=>y.fetch(e,h).then(({content:e})=>e),initial:p,fallback:s,expiration:c});return(0,n.useEffect)(()=>{d&&f(e=>e!==m?m:e)},[m,d]),m}},19683:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useCroct=function(){let e=(0,n.useContext)(i.CroctContext);if(null===e)throw Error("useCroct() can only be used in the context of a <CroctProvider> component. For help, see https://croct.help/sdk/react/missing-provider");return e.plug};let n=r(2265),i=r(27740)},75136:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useEvaluation=void 0;let n=r(2265),i=r(34537),o=r(19683),s=r(3124),a=r(76787);t.useEvaluation=(0,s.isSsr)()?function(e,{initial:t}={}){if(void 0===t)throw Error("The initial value is required for server-side rendering (SSR). For help, see https://croct.help/sdk/react/missing-evaluation-result");return t}:function(e,t={}){var r;let{cacheKey:s,fallback:u,expiration:c,staleWhileLoading:l=!1,initial:d,...h}=t,[p,f]=(0,n.useState)(d),g=(0,o.useCroct)(),y=(0,i.useLoader)({cacheKey:(0,a.hash)(`useEvaluation:${null!=s?s:""}:${e}:${JSON.stringify(null!==(r=t.attributes)&&void 0!==r?r:{})}`),loader:()=>g.evaluate(e,function(e){let t={};for(let[r,n]of Object.entries(e))void 0!==n&&(t[r]=n);return t}(h)),initial:p,fallback:u,expiration:c});return(0,n.useEffect)(()=>{l&&f(e=>e!==y?y:e)},[y,l]),y}},34537:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useLoader=function({initial:e,...t}){var r;let{cacheKey:i}=t,a=null===(r=o.get(i))||void 0===r?void 0:r.result,[u,c]=(0,n.useState)(void 0!==a?a:e),l=(0,n.useRef)(!0),d=(0,n.useRef)(e),h=(0,n.useRef)(i),p=s(()=>{try{c(o.load(t))}catch(e){if(e instanceof Promise){e.then(e=>{l.current&&c(e)});return}c(void 0)}}),f=s(()=>{var t;let r=null===(t=o.get(i))||void 0===t?void 0:t.result;c(void 0!==r?r:e),p()});return((0,n.useEffect)(()=>{h.current!==i&&(f(),h.current=i)},[f,i]),(0,n.useEffect)(()=>(void 0!==d.current&&p(),()=>{l.current=!1}),[p]),void 0===u)?o.load(t):u};let n=r(2265),i=r(14754),o=new i.Cache(6e4);function s(e){let t=(0,n.useRef)();return(0,n.useEffect)(()=>{t.current=e}),(0,n.useCallback)(()=>{var e;null===(e=t.current)||void 0===e||e.call(t)},[])}},57969:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),i(r(82229),t),i(r(63470),t),i(r(47769),t),i(r(27740),t),i(r(73377),t),i(r(10596),t)},3124:function(e,t,r){"use strict";let n,i,o;var s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.croct=void 0,t.isSsr=u;let a=s(r(33139));function u(){return"undefined"==typeof window||void 0===window.document||void 0===window.document.createElement}t.croct=u()?new Proxy(a.default,{get:function(e,t){switch(t){case"initialized":return!1;case"plug":return()=>{};case"unplug":return()=>Promise.resolve();default:throw Error(`Property croct.${String(t)} is not supported on server-side (SSR). Consider refactoring  the logic as a side-effect (useEffect) or a client-side callback (onClick, onChange, etc). For help, see https://croct.help/sdk/react/client-logic-ssr`)}}}):(o=null,new Proxy(a.default,{get:function(e,t){switch(t){case"plug":null!==o&&(clearTimeout(o),o=null,null==i||i(Error("Unplug cancelled.")));break;case"unplug":return()=>(o=setTimeout(()=>e.unplug().then(n,i),100),new Promise((e,t)=>{n=e,i=t}))}return e[t]}}))},47769:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},50233:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PREVIEW_WIDGET_URL=t.PREVIEW_WIDGET_ORIGIN=t.PLAYGROUND_CONNECT_URL=t.PLAYGROUND_ORIGIN=t.CDN_URL=void 0,t.CDN_URL="https://cdn.croct.io/js/v1/lib/plug.js",t.PLAYGROUND_ORIGIN="https://play.croct.com",t.PLAYGROUND_CONNECT_URL="https://play.croct.com/connect.html",t.PREVIEW_WIDGET_ORIGIN="https://cdn.croct.io",t.PREVIEW_WIDGET_URL="https://cdn.croct.io/js/v1/lib/plug/widget-0.16.3.html"},33139:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(49988);t.default=new n.GlobalPlug},87565:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.factory=t.PlaygroundPlugin=void 0;let n=r(66913),i=r(72156),o=r(50233);class s{constructor(e){this.sdkVersion=e.sdkVersion,this.appId=e.appId,this.connectionId=e.connectionId,this.tab=e.tab,this.contextFactory=e.contextFactory,this.storage=e.storage,this.eventSubscriber=e.eventSubscriber,this.cidAssigner=e.cidAssigner,this.tokenProvider=e.tokenProvider,this.logger=e.logger}enable(){let e=this.resolveConnectionId();if(null!==e)return this.syncListener=()=>this.cidAssigner.assignCid().then(t=>{this.syncToken(e,t)}).catch(e=>{this.logger.warn(`Sync failed: ${(0,n.formatCause)(e)}`)}),this.eventSubscriber.addListener("tokenChanged",this.syncListener),this.tab.addListener("urlChange",this.syncListener),this.syncListener()}resolveConnectionId(){if(void 0!==this.connectionId)return this.logger.debug("Connection ID passed in configuration"),this.connectionId;let e=new URL(this.tab.url),t=e.searchParams.get("__cplay");return null===t||""===t?(this.logger.debug("No connection ID found in URL"),t=this.storage.getItem("connectionId"),this.logger.debug(null!==t?"Previous connection ID found":"No previous connection ID found")):(this.logger.debug("Connection ID found in URL"),this.storage.setItem("connectionId",t)),t}disable(){void 0!==this.syncListener&&(this.eventSubscriber.removeListener("tokenChanged",this.syncListener),this.tab.removeListener("urlChange",this.syncListener),delete this.syncListener)}syncToken(e,t){let r=document.createElement("iframe");r.setAttribute("src",o.PLAYGROUND_CONNECT_URL),r.setAttribute("sandbox","allow-scripts allow-same-origin"),r.style.visibility="hidden",r.style.opacity="0",r.style.border="0",r.style.width="0",r.style.height="0";let n=this.createContext();r.onload=()=>{var i,s;if(null===r.contentWindow){document.body.contains(r)&&document.body.removeChild(r),this.logger.warn("Sync handshake failed");return}let a=t=>{t.origin===o.PLAYGROUND_ORIGIN&&t.data===e&&(window.removeEventListener("message",a),document.body.contains(r)&&document.body.removeChild(r),this.logger.debug("Sync completed"))};window.addEventListener("message",a);let u={appId:this.appId,connectionId:e,sdkVersion:this.sdkVersion,tabId:this.tab.id,cid:t,token:null!==(s=null===(i=this.tokenProvider.getToken())||void 0===i?void 0:i.toString())&&void 0!==s?s:null,context:n};r.contentWindow.postMessage(u,o.PLAYGROUND_ORIGIN),this.logger.debug("Waiting for sync acknowledgment...")},this.logger.debug("Sync started");let i=()=>{document.body.appendChild(r)};null===document.body?document.addEventListener("DOMContentLoaded",i):i()}createContext(){let{page:e,campaign:t,timeZone:r}=this.contextFactory.createContext(),n={};return void 0!==e&&(n.page=e),void 0!==t&&(n.campaign=t),void 0!==r&&(n.timeZone=r),n}}t.PlaygroundPlugin=s,t.factory=e=>{let{sdk:t,options:r}=e;return new s({sdkVersion:t.version,appId:t.appId,connectionId:r.connectionId,tab:t.tab,storage:t.getTabStorage(),tokenProvider:t.userTokenStore,cidAssigner:t.cidAssigner,contextFactory:new i.TabContextFactory(t.tab),eventSubscriber:t.eventManager,logger:t.getLogger()})}},49988:function(e,t,r){"use strict";var n=r(62601);Object.defineProperty(t,"__esModule",{value:!0}),t.GlobalPlug=void 0;let i=r(88103),o=r(66913),s=r(27346),a=r(63963),u=r(79402),c=r(50233),l=r(87565),d=r(46536),h="Plugin";class p{constructor(){this.pluginFactories={playground:l.factory,preview:d.factory},this.plugins={},this.ready=new Promise(e=>{this.initialize=e})}extend(e,t){if(void 0!==this.pluginFactories[e])throw Error(`Another plugin is already registered with name "${e}".`);this.pluginFactories[e]=t}plug(e={}){var t,r,a;if(void 0!==this.instance){let e=this.instance.getLogger();e.info("Croct is already plugged in.");return}let l=function(){let e=window.document.querySelector(`script[src^='${c.CDN_URL}']`);return e instanceof HTMLScriptElement?new URL(e.src).searchParams.get("appId"):null}(),d=null!==(t=e.appId)&&void 0!==t?t:null;if(null!==l&&null!==d&&l!==d)throw Error('The specified app ID and the auto-detected app ID are conflicting. There is no need to specify an app ID when using an application-specific tag. Please try again omitting the "appId" option. For help, see https://croct.help/sdk/javascript/conflicting-app-id');let p=null!=l?l:d;if(null===p)throw Error('The app ID must be specified when it cannot be auto-detected. Please try again specifying the "appId" option.For help, see https://croct.help/sdk/javascript/missing-app-id');let{plugins:f,test:g,...y}=e,m=i.SdkFacade.init({...y,appId:p,test:null!=g?g:"object"==typeof n&&((null===(r=n.env)||void 0===r?void 0:r.CROCT_TEST_MODE)!==void 0?"true"===n.env.CROCT_TEST_MODE:(null===(a=n.env)||void 0===a?void 0:"production")==="test")});this.instance=m;let v=this.instance.getLogger();l===d&&v.warn('It is strongly recommended omitting the "appId" option when using the application-specific tag as it is detected automatically.');let b=[],w=Object.fromEntries(Object.keys(this.pluginFactories).map(e=>[e,!0]));for(let[e,t]of Object.entries({...w,...f})){let r;v.debug(`Initializing plugin "${e}"...`);let n=this.pluginFactories[e];if(void 0===n){v.error(`Plugin "${e}" is not registered.`);continue}if("boolean"!=typeof t&&(null===t||"object"!=typeof t)){v.error(`Invalid options for plugin "${e}", expected either boolean or object but got ${(0,s.describe)(t)}`);continue}if(!1===t){v.warn(`Plugin "${e}" is declared but not enabled`);continue}let i={options:!0===t?{}:t,sdk:{version:u.VERSION,appId:p,tracker:m.tracker,evaluator:m.evaluator,user:m.user,session:m.session,tab:m.context.getTab(),userTokenStore:{getToken:m.getToken.bind(m),setToken:m.setToken.bind(m)},previewTokenStore:m.previewTokenStore,cidAssigner:m.cidAssigner,eventManager:m.eventManager,getLogger:(...t)=>m.getLogger(h,e,...t),getTabStorage:(...t)=>m.getTabStorage(h,e,...t),getBrowserStorage:(...t)=>m.getBrowserStorage(h,e,...t)}};try{r=n(i)}catch(t){v.error(`Failed to initialize plugin "${e}": ${(0,o.formatCause)(t)}`);continue}if(v.debug(`Plugin "${e}" initialized`),"object"!=typeof r)continue;this.plugins[e]=r;let a=r.enable();if(!(a instanceof Promise)){v.debug(`Plugin "${e}" enabled`);continue}b.push(a.then(()=>v.debug(`Plugin "${e}" enabled`)).catch(t=>v.error(`Failed to enable plugin "${e}": ${(0,o.formatCause)(t)}`)))}Promise.all(b).then(()=>{this.initialize(),v.debug("Initialization complete")})}get initialized(){return void 0!==this.instance}get plugged(){return this.ready.then(()=>this)}get flushed(){return this.tracker.flushed.then(()=>this)}get sdk(){if(void 0===this.instance)throw Error("Croct is not plugged in. For help, see https://croct.help/sdk/javascript/not-plugged-in");return this.instance}get tracker(){return this.sdk.tracker}get evaluator(){return this.sdk.evaluator}get user(){return this.sdk.user}get session(){return this.sdk.session}isAnonymous(){return this.sdk.context.isAnonymous()}getUserId(){return this.sdk.context.getUser()}identify(e){if("string"!=typeof e)throw Error("The user ID must be a string. For help, see https://croct.help/sdk/javascript/invalid-user-id");this.sdk.identify(e)}anonymize(){this.sdk.anonymize()}setToken(e){this.sdk.setToken(a.Token.parse(e))}unsetToken(){this.sdk.unsetToken()}track(e,t){return this.sdk.tracker.track(e,t)}evaluate(e,t={}){return this.sdk.evaluator.evaluate(e,t).catch(t=>{let r=this.sdk.getLogger(),n=e.length>20?`${e.slice(0,20)}...`:e;throw r.error(`Failed to evaluate query "${n}": ${(0,o.formatCause)(t)}`),t})}test(e,t={}){return this.evaluate(e,t).then(e=>!0===e)}fetch(e,t={}){let[r,n="latest"]=e.split("@"),i=this.sdk.getLogger();return this.sdk.contentFetcher.fetch(r,"latest"===n?t:{...t,version:n}).catch(e=>{throw i.error(`Failed to fetch content for slot "${r}@${n}": ${(0,o.formatCause)(e)}`),e})}async unplug(){if(void 0===this.instance)return;let{instance:e,plugins:t}=this,r=this.sdk.getLogger(),n=[];for(let[e,i]of Object.entries(t)){if("function"!=typeof i.disable)continue;r.debug(`Disabling plugin "${e}"...`);let t=i.disable();if(!(t instanceof Promise)){r.debug(`Plugin "${e}" disabled`);continue}n.push(t.then(()=>r.debug(`Plugin "${e}" disabled`)).catch(t=>r.error(`Failed to disable "${e}": ${(0,o.formatCause)(t)}`)))}delete this.instance,this.plugins={},this.ready=new Promise(e=>{this.initialize=e}),await Promise.all(n);try{await e.close()}finally{r.info("\uD83D\uDD0C Croct has been unplugged.")}}}t.GlobalPlug=p},46536:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.factory=t.PreviewPlugin=void 0;let n=r(66913),i=r(36332),o=r(50233),s="croct-preview",a="exit";class u{constructor(e){this.cleanUp=[],this.tokenStore=e.tokenStore,this.logger=e.logger}enable(){let e=new URL(window.location.href),t=e.searchParams.get(s);null!==t&&(this.updateToken(t),this.updateUrl(),setTimeout(this.updateUrl,500));let r=this.tokenStore.getToken();null!==r&&this.insertWidget(this.getWidgetUrl(r))}disable(){let e=this.cleanUp.splice(0);e.forEach(e=>e())}updateToken(e){if(e===a){this.logger.debug("Exiting preview mode."),this.tokenStore.setToken(null);return}try{let t=i.Token.parse(e),{exp:r}=t.getPayload();void 0!==r&&r<=Date.now()/1e3&&(this.logger.debug("Preview token expired."),t=null),this.logger.debug("Preview token updated."),this.tokenStore.setToken(t)}catch(e){this.tokenStore.setToken(null),this.logger.warn(`Invalid preview token: ${(0,n.formatCause)(e)}`)}}getWidgetUrl(e){let t=this.getWidgetParams(e),r=t.toString();return""!==r&&(r=`?${r}`),`${o.PREVIEW_WIDGET_URL}${r}`}getWidgetParams(e){let{metadata:t={}}=e.getPayload(),r=new URLSearchParams;if(null===t||"object"!=typeof t||Array.isArray(t))return r;for(let[e,n]of Object.entries(u.PREVIEW_PARAMS)){let i=t[e];"string"==typeof i&&r.set(n,i)}return r}insertWidget(e){let t=this.createWidget(e),r=e=>{if(e.origin===o.PREVIEW_WIDGET_ORIGIN)switch(e.data.type){case"croct:preview:leave":{this.tokenStore.setToken(null);let e=new URL(window.location.href);e.searchParams.set(s,a),window.location.replace(e.toString());break}case"croct:preview:resize":t.style.width=`${e.data.width}px`,t.style.height=`${e.data.height}px`}};window.addEventListener("message",r),this.cleanUp.push(()=>window.removeEventListener("message",r));let n=()=>{let e=document.body;e.prepend(t),this.cleanUp.push(()=>e.removeChild(t)),this.logger.debug("Preview widget mounted.");let r=new MutationObserver(()=>{e.contains(t)||(e.prepend(t),this.logger.debug("Preview widget removed from DOM, reinserting."))});r.observe(e,{childList:!0}),this.cleanUp.unshift(()=>r.disconnect())};"loading"!==document.readyState?n():(this.logger.debug("Waiting for document to be ready."),this.cleanUp.push(()=>window.removeEventListener("DOMContentLoaded",n)),window.addEventListener("DOMContentLoaded",n))}updateUrl(){let e=new URL(window.location.href);e.searchParams.has(s)&&(e.searchParams.delete(s),window.history.replaceState({},"",e.toString()))}createWidget(e){let t=document.createElement("iframe");return t.setAttribute("src",e),t.setAttribute("sandbox","allow-scripts allow-same-origin"),t.style.position="fixed",t.style.width="0px",t.style.height="0px",t.style.right="0",t.style.bottom="0",t.style.border="0",t.style.overflow="hidden",t.style.zIndex="2147483647",t}}t.PreviewPlugin=u,u.PREVIEW_PARAMS={previewMode:"previewMode",experienceName:"experience",experimentName:"experiment",audienceName:"audience",variantName:"variant",locale:"locale"},t.factory=e=>{let{sdk:t}=e;return new u({tokenStore:e.sdk.previewTokenStore,logger:t.getLogger()})}},82229:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(8687);n.__exportStar(r(96603),t)},36332:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Token=void 0;var n=r(63963);Object.defineProperty(t,"Token",{enumerable:!0,get:function(){return n.Token}})},63470:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},85974:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ActiveRecord=void 0;let n=r(78004),i={add:n.addOperation,set:n.setOperation,merge:n.mergeOperation,combine:n.combineOperation,increment:n.incrementOperation,decrement:n.decrementOperation,clear:n.clearOperation,unset:n.unsetOperation,remove:n.removeOperation};class o{constructor(){this.operations=[]}set(e,t){return"string"==typeof e?this.pushOperation({type:"set",path:e,value:t}):this.pushOperation({type:"set",path:".",value:e})}add(e,t){return this.pushOperation({type:"add",path:e,value:t})}combine(e,t){return this.pushOperation({type:"combine",path:e,value:t})}merge(e,t){return"string"==typeof e?this.pushOperation({type:"merge",path:e,value:t}):this.pushOperation({type:"merge",path:".",value:e})}increment(e,t=1){return this.pushOperation({type:"increment",path:e,value:t})}decrement(e,t=1){return this.pushOperation({type:"decrement",path:e,value:t})}clear(e){return this.pushOperation({type:"clear",path:e})}unset(e){return this.pushOperation({type:"unset",path:e})}remove(e,t){return this.pushOperation({type:"remove",path:e,value:t})}pushOperation(e){let{type:t,...r}=e;return i[t].validate(r),this.operations.push(e),this}reset(){return this.operations.splice(0),this}isDirty(){return this.operations.length>0}buildPatch(){return{operations:this.operations.slice()}}}t.ActiveRecord=o},38999:function(e,t){"use strict";function r(e){return(e+"===".slice((e.length+3)%4)).replace(/-/g,"+").replace(/_/g,"/")}function n(e){return e.replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}Object.defineProperty(t,"__esModule",{value:!0}),t.base64UrlEncode=function(e,t=!1){return t?n(btoa(String.fromCodePoint(...new TextEncoder().encode(e)))):n(btoa(e))},t.base64UrlDecode=function(e,t=!1){return t?new TextDecoder().decode(Uint8Array.from(atob(r(e)),e=>e.codePointAt(0))):atob(r(e))}},52099:function(e,t){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.ObservableCache=void 0,(r||(t.ObservableCache=r={})).isObservable=function(e){return"function"==typeof e.addListener&&"function"==typeof e.removeListener}},34844:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CookieCache=void 0;class r{constructor(e,t="https:"===window.location.protocol){var r;this.config={...e,path:null!==(r=e.path)&&void 0!==r?r:"/"},t&&void 0===this.config.secure&&(this.config.secure=!0),!0===this.config.secure&&void 0===this.config.sameSite&&(this.config.sameSite="none")}get(){let e=document.cookie.split(";");for(let t of e){let[e,n]=t.split("=");if(r.decode(e).trim()===this.config.name)return r.decode(n.trim())}return null}put(e){document.cookie=r.serializeCookie(e,this.config)}clear(){document.cookie=r.serializeCookie("",{...this.config,maxAge:0})}static serializeCookie(e,t){let n=[`${r.encode(t.name)}=${r.encode(e)}`];return void 0!==t.maxAge&&n.push(`Max-Age=${t.maxAge}`),void 0!==t.domain&&n.push(`Domain=${r.encode(t.domain)}`),void 0!==t.path&&n.push(`Path=${r.encode(t.path)}`),!0===t.secure&&n.push("Secure"),void 0!==t.sameSite&&n.push(`SameSite=${{strict:"Strict",lax:"Lax",none:"None"}[t.sameSite]}`),n.join("; ")}static encode(e){return e.replace(/[,; ]+/g,encodeURIComponent)}static decode(e){return decodeURIComponent(e)}}t.CookieCache=r},31595:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FallbackCache=void 0;class r{constructor(...e){this.caches=e}get(){for(let e of this.caches){let t=e.get();if(null!==t)return t}return null}put(e){this.caches.forEach(t=>t.put(e))}clear(){this.caches.forEach(e=>e.clear())}}t.FallbackCache=r},97208:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.InMemoryCache=void 0;class r{constructor(e){this.cache=e}get(){var e;return null!==(e=this.cache)&&void 0!==e?e:null}put(e){this.cache=e}clear(){delete this.cache}}t.InMemoryCache=r},25687:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LocalStorageCache=t.InMemoryCache=t.FallbackCache=void 0;let n=r(99094);n.__exportStar(r(52099),t);var i=r(31595);Object.defineProperty(t,"FallbackCache",{enumerable:!0,get:function(){return i.FallbackCache}});var o=r(97208);Object.defineProperty(t,"InMemoryCache",{enumerable:!0,get:function(){return o.InMemoryCache}});var s=r(20970);Object.defineProperty(t,"LocalStorageCache",{enumerable:!0,get:function(){return s.LocalStorageCache}})},20970:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LocalStorageCache=void 0;class r{constructor(e,t){this.listeners=[],this.storage=e,this.key=t,this.value=e.getItem(t)}static autoSync(e){let t=e.sync.bind(e);return window.addEventListener("storage",t),()=>window.removeEventListener("storage",t)}get(){return this.value}put(e){this.storage.setItem(this.key,e),this.value!==e&&(this.value=e,this.notifyChange(e))}clear(){this.storage.removeItem(this.key),null!==this.value&&(this.value=null,this.notifyChange(null))}addListener(e){this.listeners.includes(e)||this.listeners.push(e)}removeListener(e){let t=this.listeners.indexOf(e);t>-1&&this.listeners.splice(t,1)}notifyChange(e){this.listeners.forEach(t=>t(e))}sync(e){if(e.storageArea!==this.storage||null!==e.key&&e.key!==this.key)return;let t=this.storage.getItem(this.key);this.value!==t&&(this.value=t,this.notifyChange(t))}}t.LocalStorageCache=r},25387:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MessageDeliveryError=void 0;let n=r(66913);class i extends Error{constructor(e,t){super(e),this.retryable=t,Object.setPrototypeOf(this,i.prototype)}static retryable(e){return i.fromCause(e,!0)}static nonRetryable(e){return i.fromCause(e,!1)}static fromCause(e,t){let r=new i((0,n.formatMessage)(e),t);return e instanceof Error&&(r.stack=e.stack),r}}t.MessageDeliveryError=i},55728:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EncodedChannel=void 0;class r{constructor(e,t){this.channel=e,this.encode=t}publish(e){return this.encode(e).then(e=>this.channel.publish(e))}close(){return this.channel.close()}}t.EncodedChannel=r},12585:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GuaranteedChannel=t.TimeStamper=void 0;let n=r(4592),i=r(25387);class o{generate(){return String(Date.now())}}t.TimeStamper=o;class s{constructor({channel:e,logger:t,stamper:r,...i}){var o;this.closed=!1,this.channel=e,this.logger=null!=t?t:new n.NullLogger,this.stamper=r,this.options={...i,ackTimeout:null!==(o=i.ackTimeout)&&void 0!==o?o:5e3}}publish(e){return this.closed?Promise.reject(i.MessageDeliveryError.nonRetryable("Channel is closed.")):new Promise((t,r)=>{let n,o;let s=this.stamper.generate(e),a=!1,u=Date.now(),c=e=>{if(e===s){a=!0;let e=Date.now()-u;window.clearTimeout(n),window.clearInterval(o),this.logger.debug(`Delivery confirmed #${s}, elapsed ${e}ms.`),this.channel.unsubscribe(c),t()}};this.channel.subscribe(c);let l=e=>{window.clearTimeout(n),window.clearInterval(o),this.logger.error(`Failed to send message #${s}`),this.channel.unsubscribe(c),r(e)};this.logger.debug(`Sending message #${s}...`),this.channel.publish({id:s,message:e}).then(()=>{a||(o=window.setInterval(()=>{this.closed&&l(i.MessageDeliveryError.nonRetryable("Connection deliberately closed."))},0),this.logger.debug(`Waiting confirmation #${s}...`),n=window.setTimeout(()=>{l(i.MessageDeliveryError.retryable("Maximum confirmation time reached."))},this.options.ackTimeout))},l)})}close(){return this.closed=!0,this.channel.close()}}t.GuaranteedChannel=s},79771:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HttpBeaconChannel=void 0;let n=r(25387),i=r(4592),o=r(66913),s=r(54776),a=r(31341);class u{constructor({logger:e=new i.NullLogger,...t}){this.listeners=[],this.closed=!1,this.configuration=t,this.logger=e}async publish({id:e,message:t}){if(this.closed)return Promise.reject(n.MessageDeliveryError.nonRetryable("Channel is closed"));let{token:r,timestamp:i,context:c,payload:l}=JSON.parse(t),{endpointUrl:d,appId:h,cidAssigner:p}=this.configuration;return fetch(d,{method:"POST",headers:{"X-App-Id":h,"X-Client-Id":await p.assignCid(),"X-Client-Library":s.CLIENT_LIBRARY,"Content-Type":"application/json",...void 0!==r?{"X-Token":r}:{}},body:JSON.stringify({context:c,payload:l,originalTime:i,departureTime:Date.now()})}).then(async t=>{if(t.ok){this.notify(e);return}let r=await t.json().catch(()=>({type:"https://croct.help/api/event-tracker#unexpected-error",title:t.statusText,status:t.status})),i=u.isRetryable(r.status),o=a.Help.forStatusCode(r.status);return void 0!==o?this.logger.error(o):i||this.logger.error(`Beacon rejected with non-retryable status: ${r.title}`),Promise.reject(i?n.MessageDeliveryError.retryable(r.title):n.MessageDeliveryError.nonRetryable(r.title))}).catch(e=>(this.logger.error(`Failed to publish beacon: ${(0,o.formatMessage)(e)}`),Promise.reject(e instanceof n.MessageDeliveryError?e:n.MessageDeliveryError.retryable(e))))}subscribe(e){this.listeners.includes(e)||this.listeners.push(e)}unsubscribe(e){let t=this.listeners.indexOf(e);t>=0&&this.listeners.splice(t,1)}notify(e){this.listeners.forEach(t=>t(e))}close(){return this.closed=!0,Promise.resolve()}static isRetryable(e){return e>=500||429===e||408===e}}t.HttpBeaconChannel=u},3739:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HttpBeaconChannel=t.SandboxChannel=t.RetryChannel=t.QueuedChannel=t.GuaranteedChannel=t.EncodedChannel=void 0;let n=r(99094);n.__exportStar(r(25387),t);var i=r(55728);Object.defineProperty(t,"EncodedChannel",{enumerable:!0,get:function(){return i.EncodedChannel}});var o=r(12585);Object.defineProperty(t,"GuaranteedChannel",{enumerable:!0,get:function(){return o.GuaranteedChannel}});var s=r(65745);Object.defineProperty(t,"QueuedChannel",{enumerable:!0,get:function(){return s.QueuedChannel}});var a=r(11428);Object.defineProperty(t,"RetryChannel",{enumerable:!0,get:function(){return a.RetryChannel}});var u=r(1907);Object.defineProperty(t,"SandboxChannel",{enumerable:!0,get:function(){return u.SandboxChannel}});var c=r(79771);Object.defineProperty(t,"HttpBeaconChannel",{enumerable:!0,get:function(){return c.HttpBeaconChannel}})},65745:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.QueuedChannel=void 0;let n=r(25387),i=r(4592);class o{constructor(e,t,r){this.closed=!1,this.channel=e,this.queue=t,this.logger=null!=r?r:new i.NullLogger}flush(){return void 0===this.pending?this.requeue():this.pending.catch(this.requeue.bind(this))}publish(e){return this.closed?Promise.reject(n.MessageDeliveryError.nonRetryable("Channel is closed.")):this.queue.length()>=this.queue.getCapacity()?(this.logger.warn("The queue is full, message rejected."),Promise.reject(n.MessageDeliveryError.retryable("The queue is full."))):(void 0===this.pending&&(this.pending=this.queue.isEmpty()?Promise.resolve():Promise.reject(n.MessageDeliveryError.retryable("The queue must be flushed."))),this.enqueue(e),this.pending=this.pending.then(()=>this.channel.publish(e).then(this.dequeue.bind(this))),this.pending)}enqueue(e){this.logger.debug("Enqueueing message..."),this.logger.debug(`Queue length: ${this.queue.length()+1}`),this.queue.push(e)}dequeue(){this.logger.debug("Dequeuing message..."),this.logger.debug(`Queue length: ${Math.max(0,this.queue.length()-1)}`),this.queue.shift()}requeue(){if(this.closed)return Promise.reject(n.MessageDeliveryError.nonRetryable("Channel is closed."));if(this.pending=Promise.resolve(),this.queue.isEmpty())return this.pending;let e=this.queue.length();for(let t of(this.logger.debug("Requeuing messages..."),this.logger.debug(`Queue length: ${e}`),this.queue.all()))this.pending=this.pending.then(()=>this.channel.publish(t).then(this.dequeue.bind(this)));return this.pending}async close(){if(this.closed=!0,await this.channel.close(),void 0!==this.pending)try{await this.pending}catch{}}}t.QueuedChannel=o},11428:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RetryChannel=void 0;let n=r(25387),i=r(4592);class o{constructor({channel:e,retryPolicy:t,logger:r}){this.closed=!1,this.channel=e,this.retryPolicy=t,this.logger=null!=r?r:new i.NullLogger}publish(e){return this.closed?Promise.reject(n.MessageDeliveryError.nonRetryable("The channel is closed.")):this.channel.publish(e).catch(t=>this.retry(e,t))}async retry(e,t){if(t instanceof n.MessageDeliveryError&&!t.retryable)throw t;let r=0;for(;this.retryPolicy.shouldRetry(r,e,t);){if(this.closed)throw n.MessageDeliveryError.nonRetryable("Connection deliberately closed.");let t=this.retryPolicy.getDelay(r);this.logger.debug(`Retry attempt ${r+1}`),t>0&&(this.logger.debug(`Retry attempt delayed in ${t}ms`),await new Promise((e,r)=>{let i=window.setInterval(()=>{this.closed&&(window.clearInterval(i),r(n.MessageDeliveryError.nonRetryable("Connection deliberately closed.")))},0);window.setTimeout(()=>{window.clearInterval(i),e()},t)}));try{return await this.channel.publish(e)}catch{r+=1}}throw n.MessageDeliveryError.nonRetryable("Maximum retry attempts reached.")}close(){return this.closed=!0,this.channel.close()}}t.RetryChannel=o},1907:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SandboxChannel=void 0;let n=r(25387);class i{constructor(){this.listeners=[],this.messages=[],this.closed=!1}publish(e){return this.closed?Promise.reject(n.MessageDeliveryError.nonRetryable("Channel is closed.")):(this.messages.push(e),Promise.resolve())}notify(e){this.listeners.forEach(t=>t(e))}subscribe(e){this.listeners.includes(e)||this.listeners.push(e)}unsubscribe(e){let t=this.listeners.indexOf(e);t>=0&&this.listeners.splice(t,1)}close(){return this.closed=!0,Promise.resolve()}isClosed(){return this.closed}}t.SandboxChannel=i},19350:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},39914:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CachedAssigner=void 0;let n=r(4592);class i{constructor(e,t,r={}){var i,o;this.assigner=e,this.cache=t,this.options={logger:null!==(i=r.logger)&&void 0!==i?i:new n.NullLogger,mirror:null!==(o=r.mirror)&&void 0!==o&&o}}async assignCid(e){var t;let r=this.cache.get(),n=null!==(t=null!=e?e:r)&&void 0!==t?t:null,{logger:i,mirror:o}=this.options;if(null===n){let e=await this.assigner.assignCid();return this.cache.put(e),i.debug("New CID stored into cache"),e}return i.debug("Using existing CID"),r!==n&&(i.debug("The cached CID is stale, updating cache..."),this.cache.put(n)),o&&(i.debug("Mirroring CID"),this.assigner.assignCid(n).then(e=>{e!==n&&(i.warn("The CID has changed, updating cache..."),this.cache.put(e))}).catch(()=>{i.error("Failed to mirror CID")})),n}}t.CachedAssigner=i},44418:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FixedAssigner=void 0;class r{constructor(e){this.cid=e}assignCid(){return Promise.resolve(this.cid)}}t.FixedAssigner=r},5452:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RemoteAssigner=t.FixedAssigner=t.CachedAssigner=void 0;let n=r(99094);n.__exportStar(r(19350),t);var i=r(39914);Object.defineProperty(t,"CachedAssigner",{enumerable:!0,get:function(){return i.CachedAssigner}});var o=r(44418);Object.defineProperty(t,"FixedAssigner",{enumerable:!0,get:function(){return o.FixedAssigner}});var s=r(84493);Object.defineProperty(t,"RemoteAssigner",{enumerable:!0,get:function(){return s.RemoteAssigner}})},84493:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RemoteAssigner=void 0;let n=r(4592),i=r(66913),o=r(54776);class s{constructor(e,t){this.endpoint=e,this.logger=null!=t?t:new n.NullLogger}assignCid(e){return void 0===this.pending&&(this.pending=this.fetchCid(e).finally(()=>{this.pending=void 0})),this.pending}async fetchCid(e){let t={method:"GET",credentials:"include",headers:{"X-Client-Library":o.CLIENT_LIBRARY}},r=new URL(this.endpoint);void 0!==e&&r.searchParams.set("cid",e);let n=await fetch(r,t);if(!n.ok){let e=Error(`Failed to assign CID: ${(0,i.formatCause)(n.statusText)}`);throw this.logger.error(e.message),e}return this.logger.debug("New CID successfully assigned"),n.text()}}t.RemoteAssigner=s},54776:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CLIENT_LIBRARY=t.VERSION=t.MAX_QUERY_LENGTH=t.BASE_ENDPOINT_URL=void 0,t.BASE_ENDPOINT_URL="https://api.croct.io",t.MAX_QUERY_LENGTH=500,t.VERSION="0.17.5",t.CLIENT_LIBRARY=`Croct SDK JS v${t.VERSION}`},12880:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Container=void 0;let n=r(4592),i=r(36774),o=r(63690),s=r(19604),a=r(55940),u=r(63963),c=r(56402),l=r(86148),d=r(57379),h=r(5452),p=r(85916),f=r(25687),g=r(12585),y=r(3739),m=r(41366),v=r(34844),b=r(54638),w=r(79771);class T{constructor(e){this.eventManager=new p.SynchronousEventManager,this.configuration=e}getConfiguration(){return this.configuration}getEvaluator(){return void 0===this.evaluator&&(this.evaluator=this.createEvaluator()),this.evaluator}createEvaluator(){var e;return new l.Evaluator({appId:this.configuration.appId,baseEndpointUrl:this.configuration.evaluationBaseEndpointUrl,logger:this.getLogger("Evaluator"),defaultTimeout:null!==(e=this.configuration.defaultFetchTimeout)&&void 0!==e?e:T.DEFAULT_FETCH_TIMEOUT})}getContentFetcher(){return void 0===this.contentFetcher&&(this.contentFetcher=this.createContentFetcher()),this.contentFetcher}createContentFetcher(){var e;return new m.ContentFetcher({appId:this.configuration.appId,baseEndpointUrl:this.configuration.contentBaseEndpointUrl,logger:this.getLogger("ContentFetcher"),defaultTimeout:null!==(e=this.configuration.defaultFetchTimeout)&&void 0!==e?e:T.DEFAULT_FETCH_TIMEOUT,defaultPreferredLocale:this.configuration.defaultPreferredLocale})}getPreviewTokenStore(){var e;return void 0===this.previewTokenStore&&(this.previewTokenStore=new u.CachedTokenStore((null===(e=this.configuration.cookie)||void 0===e?void 0:e.previewToken)!==void 0?new v.CookieCache(this.configuration.cookie.previewToken):new f.LocalStorageCache(this.getGlobalBrowserStorage("preview"),"token"))),this.previewTokenStore}getTracker(){return void 0===this.tracker&&(this.tracker=this.createTracker()),this.tracker}createTracker(){let e=this.getContext(),t=new c.Tracker({tab:e.getTab(),tokenProvider:this.getUserTokenStore(),inactivityRetryPolicy:new s.ArbitraryPolicy([3e4,3e4,12e4,12e4,3e5,3e5,9e5]),logger:this.getLogger("Tracker"),channel:this.getBeaconChannel(),eventMetadata:this.configuration.eventMetadata,processor:void 0===this.configuration.eventProcessor?void 0:this.configuration.eventProcessor(this)}),r=this.getBeaconQueue();return r.addCallback("halfEmpty",t.unsuspend),r.addCallback("full",t.suspend),t}getUserTokenStore(){if(void 0===this.userTokenProvider){let e=this.getContext();this.userTokenProvider={getToken:e.getToken.bind(e),setToken:e.setToken.bind(e)}}return this.userTokenProvider}getContext(){return void 0===this.context&&(this.context=this.createContext()),this.context}createContext(){var e;let t=this.resolveStorageNamespace("token"),r=this.resolveStorageNamespace("tab"),n="global"===this.configuration.tokenScope&&(null===(e=this.configuration.cookie)||void 0===e?void 0:e.userToken)!==void 0?new v.CookieCache(this.configuration.cookie.userToken):new f.LocalStorageCache(this.getLocalStorage(),t),o=this.getSessionStorage();return n instanceof f.LocalStorageCache&&(this.removeTokenSyncListener=f.LocalStorageCache.autoSync(n)),i.Context.load({tokenScope:this.configuration.tokenScope,eventDispatcher:this.getEventManager(),urlSanitizer:this.configuration.urlSanitizer,cache:{tabId:new f.LocalStorageCache(o,r),tabToken:new f.LocalStorageCache(o,t),browserToken:n}})}getBeaconChannel(){return void 0===this.beaconChannel&&(this.beaconChannel=this.createBeaconChannel()),this.beaconChannel}createBeaconChannel(){if(this.configuration.test)return new y.SandboxChannel;let e=this.getLogger("BeaconChannel"),{appId:t,trackerEndpointUrl:r}=this.configuration,n=new y.QueuedChannel(new y.RetryChannel({channel:new y.GuaranteedChannel({channel:new w.HttpBeaconChannel({appId:t,endpointUrl:r,cidAssigner:this.getCidAssigner(),logger:e}),stamper:new g.TimeStamper,ackTimeout:1e4,logger:e}),retryPolicy:new s.BackoffPolicy({minRetryDelay:3e3,maxRetryDelay:6e4,backoffFactor:1.5,backoffJitter:1}),logger:e}),this.getBeaconQueue(),e);return n.flush().catch(()=>{}),new y.EncodedChannel(n,d.encodeJson)}getCidAssigner(){return void 0===this.cidAssigner&&(this.cidAssigner=this.createCidAssigner()),this.cidAssigner}createCidAssigner(){var e,t;if(void 0!==this.configuration.clientId)return new h.FixedAssigner(this.configuration.clientId);if(this.configuration.test)return new h.FixedAssigner("00000000-0000-0000-0000-000000000000");let r=this.getLogger("CidAssigner");return new h.CachedAssigner(new h.RemoteAssigner(this.configuration.cidAssignerEndpointUrl,r),(null===(e=this.configuration.cookie)||void 0===e?void 0:e.clientId)!==void 0?new v.CookieCache(null===(t=this.configuration.cookie)||void 0===t?void 0:t.clientId):new f.LocalStorageCache(this.getLocalStorage(),"croct.cid"),{logger:r,mirror:!this.configuration.disableCidMirroring})}getBeaconQueue(){return void 0===this.beaconQueue&&(this.beaconQueue=this.createBeaconQueue()),this.beaconQueue}createBeaconQueue(){return new a.MonitoredQueue(new a.CapacityRestrictedQueue(new a.PersistentQueue(this.getGlobalTabStorage("queue")),this.configuration.beaconQueueSize),this.getLogger("BeaconQueue"))}getLogger(...e){let t=`Croct${0===e.length?"":`:${e.join(":")}`}`;return void 0!==this.configuration.logger?new n.NamespacedLogger(this.configuration.logger,t):this.configuration.debug?new n.ConsoleLogger(t):b.FilteredLogger.include(new n.ConsoleLogger,["error","warn"])}getTabStorage(e,...t){return this.getGlobalTabStorage("external",e,...t)}getBrowserStorage(e,...t){return this.getGlobalBrowserStorage("external",e,...t)}getGlobalTabStorage(e,...t){return new o.NamespacedStorage(this.getSessionStorage(),this.resolveStorageNamespace(e,...t))}getGlobalBrowserStorage(e,...t){return new o.NamespacedStorage(this.getLocalStorage(),this.resolveStorageNamespace(e,...t))}resolveStorageNamespace(e,...t){let{appId:r}=this.configuration;return`croct[${r.toLowerCase()}].${[e].concat(t).join(".")}`}getLocalStorage(){return localStorage}getSessionStorage(){return sessionStorage}getEventManager(){return this.eventManager}async dispose(){let e=this.getLogger();void 0!==this.beaconChannel&&(e.debug("Closing beacon channel..."),await this.beaconChannel.close()),void 0!==this.removeTokenSyncListener&&(e.debug("Removing token sync listener..."),this.removeTokenSyncListener()),void 0!==this.tracker&&(void 0!==this.beaconQueue&&(e.debug("Removing queue listeners..."),this.beaconQueue.removeCallback("halfEmpty",this.tracker.unsuspend),this.beaconQueue.removeCallback("full",this.tracker.suspend)),e.debug("Suspending tracker..."),this.tracker.suspend(),await this.tracker.flushed),delete this.context,delete this.userTokenProvider,delete this.previewTokenStore,delete this.cidAssigner,delete this.tracker,delete this.evaluator,delete this.contentFetcher,delete this.beaconChannel,delete this.beaconQueue,delete this.removeTokenSyncListener,e.debug("Container resources released.")}}t.Container=T,T.DEFAULT_FETCH_TIMEOUT=5e3},41366:function(e,t,r){"use strict";var n,i;Object.defineProperty(t,"__esModule",{value:!0}),t.ContentFetcher=t.ContentError=t.ContentErrorType=void 0;let o=r(54776),s=r(66913),a=r(4592),u=r(31341);(i=n||(t.ContentErrorType=n={})).TIMEOUT="https://croct.help/api/content#timeout",i.UNEXPECTED_ERROR="https://croct.help/api/content#unexpected-error";class c extends Error{constructor(e){super(e.title),this.response=e,Object.setPrototypeOf(this,c.prototype)}}t.ContentError=c;class l{constructor(e){var t;if(void 0===e.appId==(void 0===e.apiKey))throw Error("Either the application ID or the API key must be provided.");let{baseEndpointUrl:r}=e,n="object"==typeof e.apiKey?e.apiKey.getIdentifier():e.apiKey,i=(null!=r?r:o.BASE_ENDPOINT_URL).replace(/\/+$/,"")+(void 0===n?"/client":"/external")+"/web";this.dynamicEndpoint=`${i}/content`,this.staticEndpoint=`${i}/static-content`,this.logger=null!==(t=e.logger)&&void 0!==t?t:new a.NullLogger,this.configuration={appId:e.appId,apiKey:n,defaultTimeout:e.defaultTimeout,defaultPreferredLocale:e.defaultPreferredLocale}}fetch(e,t={}){if(!0===t.static&&void 0===this.configuration.apiKey)throw Error("The API key must be provided to fetch static content.");return new Promise((r,i)=>{var o;let a;let u=new AbortController,l=null!==(o=t.timeout)&&void 0!==o?o:this.configuration.defaultTimeout;void 0!==l&&(a=setTimeout(()=>{let t={title:`Content could not be loaded in time for slot '${e}'.`,type:n.TIMEOUT,detail:`The content took more than ${l}ms to load.`,status:408};u.abort(),this.logHelp(t.status),i(new c(t))},l)),this.load(e,u.signal,t).finally(()=>clearTimeout(a)).then(t=>{let n=t.headers.get("X-Croct-Region"),o=t.headers.get("X-Croct-Timing");return this.logger.debug(`Content for slot '${e}' processed by region ${n} in ${o}.`),t.json().then(e=>{if(t.ok)return r(e);this.logHelp(t.status),i(new c(e))}).catch(e=>{if(!t.ok)throw Error(`Error ${t.status} - ${t.statusText}`);throw e})}).catch(e=>{u.signal.aborted||i(new c({title:(0,s.formatMessage)(e),type:n.UNEXPECTED_ERROR,detail:"Please try again or contact Croct support if the error persists.",status:500}))})})}load(e,t,r){var n;let{apiKey:i,appId:s}=this.configuration,a={"Content-Type":"application/json"};a["X-Client-Library"]=o.CLIENT_LIBRARY,void 0!==s&&(a["X-App-Id"]=s),void 0!==i&&(a["X-Api-Key"]=i);let u={slotId:e};void 0!==r.version&&(u.version=`${r.version}`);let c=null!==(n=r.preferredLocale)&&void 0!==n?n:this.configuration.defaultPreferredLocale;void 0!==c&&(u.preferredLocale=c);let d=l.isDynamicContent(r);return d&&(void 0!==r.clientId&&(a["X-Client-Id"]=r.clientId),void 0!==r.clientIp&&(a["X-Client-Ip"]=r.clientIp),void 0!==r.userToken&&(a["X-Token"]=r.userToken.toString()),void 0!==r.clientAgent&&(a["X-Client-Agent"]=r.clientAgent),void 0!==r.context&&(u.context=r.context),void 0!==r.previewToken&&(u.previewToken=`${r.previewToken}`)),fetch(d?this.dynamicEndpoint:this.staticEndpoint,{mode:"undefined"==typeof window?void 0:"cors",credentials:"omit",...r.extra,method:"POST",headers:a,signal:t,body:JSON.stringify(u)})}logHelp(e){let t=u.Help.forStatusCode(e);void 0!==t&&this.logger.error(t)}static isDynamicContent(e){return!0!==e.static}toJSON(){throw Error("Unserializable value.")}}t.ContentFetcher=l},36774:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Context=void 0;let n=r(63963),i=r(50351),o=r(92607),s=r(25687);function a(e,t){return e===t||null!==e&&null!==t&&e.toString()===t.toString()}class u{constructor(e,t,r){this.tab=e,this.tokenStore=t,this.eventDispatcher=r,this.lastToken=t.getToken(),this.syncToken=this.syncToken.bind(this)}static load({cache:e,tokenScope:t,eventDispatcher:r,urlSanitizer:a}){let c=e.tabId.get(),l=!1;null===c&&(c=(0,o.uuid4)(!0),l=!0);let d=new i.Tab(c,l,a);switch(e.tabId.clear(),d.addListener("unload",()=>e.tabId.put(d.id)),t){case"isolated":return new u(d,new n.InMemoryTokenStore,r);case"global":{let t=new u(d,new n.CachedTokenStore(e.browserToken),r);return s.ObservableCache.isObservable(e.browserToken)&&e.browserToken.addListener(t.syncToken),t}case"contextual":{let t=new n.CachedTokenStore(e.tabToken),i=new n.CachedTokenStore(e.browserToken);return d.isNew&&t.setToken(i.getToken()),d.addListener("visibilityChange",e=>{e.detail.visible&&i.setToken(t.getToken())}),new u(d,new n.ReplicatedTokenStore(t,i),r)}}}getTab(){return this.tab}isAnonymous(){let e=this.getToken();return null==e||e.isAnonymous()}getUser(){let e=this.getToken();return null==e?null:e.getSubject()}getToken(){return this.tokenStore.getToken()}setToken(e){let t=this.lastToken;this.lastToken=e,this.tokenStore.setToken(e),a(t,e)||this.eventDispatcher.dispatch("tokenChanged",{oldToken:t,newToken:e})}syncToken(){let e=this.tokenStore.getToken(),t=this.lastToken;a(t,e)||(this.lastToken=e,this.eventDispatcher.dispatch("tokenChanged",{oldToken:t,newToken:e}))}}t.Context=u},66913:function(e,t){"use strict";function r(e){let t=e instanceof Error?e.message:"string"==typeof e&&""!==e?e:"unknown error";return 0===t.length?t:t.charAt(0).toUpperCase()+t.slice(1)}Object.defineProperty(t,"__esModule",{value:!0}),t.formatMessage=r,t.formatCause=function(e){let t=r(e);return 0===t.length?t:t.charAt(0).toLowerCase()+t.slice(1)}},86148:function(e,t,r){"use strict";var n,i;Object.defineProperty(t,"__esModule",{value:!0}),t.Evaluator=t.QueryError=t.EvaluationError=t.EvaluationErrorType=void 0;let o=r(54776),s=r(66913),a=r(38086),u=r(4592),c=r(31341);(i=n||(t.EvaluationErrorType=n={})).TIMEOUT="https://croct.help/api/evaluation#timeout",i.UNEXPECTED_ERROR="https://croct.help/api/evaluation#unexpected-error",i.INVALID_QUERY="https://croct.help/api/evaluation#invalid-query",i.TOO_COMPLEX_QUERY="https://croct.help/api/evaluation#too-complex-query",i.EVALUATION_FAILED="https://croct.help/api/evaluation#evaluation-failed",i.UNALLOWED_RESULT="https://croct.help/api/evaluation#unallowed-result",i.UNSERIALIZABLE_RESULT="https://croct.help/api/evaluation#unserializable-result";class l extends Error{constructor(e){super(e.title),this.response=e,Object.setPrototypeOf(this,l.prototype)}}t.EvaluationError=l;class d extends l{constructor(e){super(e),Object.setPrototypeOf(this,d.prototype)}}t.QueryError=d;class h{constructor(e){var t;if(void 0===e.appId==(void 0===e.apiKey))throw Error("Either the application ID or the API key must be provided.");let{baseEndpointUrl:r}=e,n="object"==typeof e.apiKey?e.apiKey.getIdentifier():e.apiKey;this.endpoint=(null!=r?r:o.BASE_ENDPOINT_URL).replace(/\/+$/,"")+(void 0===n?"/client":"/external")+"/web/evaluate",this.logger=null!==(t=e.logger)&&void 0!==t?t:new u.NullLogger,this.configuration={appId:e.appId,apiKey:n,defaultTimeout:e.defaultTimeout}}evaluate(e,t={}){let r=(0,a.getLength)(e),i=e.length>20?`${e.slice(0,20)}...`:e;if(r>h.MAX_QUERY_LENGTH){let t={title:"The query is too complex.",status:422,type:n.TOO_COMPLEX_QUERY,detail:`The query "${i}" must be at most ${h.MAX_QUERY_LENGTH} characters long, but it is ${r} characters long.`,errors:[{cause:"The query is longer than expected.",location:(0,a.getLocation)(e,0,Math.max(r-1,0))}]};return Promise.reject(new d(t))}let o={query:e};return void 0!==t.context&&(o.context=t.context),new Promise((e,r)=>{var a;let u;let c=new AbortController,h=null!==(a=t.timeout)&&void 0!==a?a:this.configuration.defaultTimeout;void 0!==h&&setTimeout(()=>{let e={title:`Evaluation could not be completed in time for query "${i}".`,type:n.TIMEOUT,detail:`The evaluation took more than ${h}ms to complete.`,status:408};c.abort(),this.logHelp(e.status),r(new l(e))},h),this.fetch(o,c.signal,t).finally(()=>clearTimeout(u)).then(t=>{let o=t.headers.get("X-Croct-Region"),s=t.headers.get("X-Croct-Timing");return this.logger.debug(`Evaluation of the query "${i}" processed by region ${o} in ${s}.`),t.json().then(i=>{if(t.ok)return e(i);switch(this.logHelp(t.status),i.type){case n.INVALID_QUERY:case n.EVALUATION_FAILED:case n.TOO_COMPLEX_QUERY:r(new d(i));break;default:r(new l(i))}}).catch(e=>{if(!t.ok)throw Error(`Error ${t.status} - ${t.statusText}`);throw e})}).catch(e=>{c.signal.aborted||r(new l({title:(0,s.formatMessage)(e),type:n.UNEXPECTED_ERROR,detail:"Please try again or contact Croct support if the error persists.",status:500}))})})}fetch(e,t,r){let{appId:n,apiKey:i}=this.configuration,{clientId:s,clientIp:a,userToken:u,clientAgent:c}=r,l={"Content-Type":"application/json"};return l["X-Client-Library"]=o.CLIENT_LIBRARY,void 0!==i?l["X-Api-Key"]=i:void 0!==n&&(l["X-App-Id"]=n),void 0!==s&&(l["X-Client-Id"]=s),void 0!==a&&(l["X-Client-Ip"]=a),void 0!==u&&(l["X-Token"]=u.toString()),void 0!==c&&(l["X-Client-Agent"]=c),fetch(this.endpoint,{mode:"undefined"==typeof window?void 0:"cors",credentials:"omit",...r.extra,method:"POST",headers:l,signal:t,body:JSON.stringify(e)})}logHelp(e){let t=c.Help.forStatusCode(e);void 0!==t&&this.logger.error(t)}toJSON(){throw Error("Unserializable value.")}}t.Evaluator=h,h.MAX_QUERY_LENGTH=o.MAX_QUERY_LENGTH},85916:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SynchronousEventManager=void 0;class r{constructor(){this.listeners={}}addListener(e,t){var r;let n=null!==(r=this.listeners[e])&&void 0!==r?r:[];n.push(t),this.listeners[e]=n}removeListener(e,t){let r=this.listeners[e];if(void 0===r)return;let n=r.indexOf(t);n>=0&&r.splice(n,1)}dispatch(e,t){let r=this.listeners[e];void 0!==r&&r.forEach(e=>e(t))}}t.SynchronousEventManager=r},69530:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EventSubjectProcessor=void 0;class r{constructor(e){this.logger=e}process(e){var t,n,i,o;let{currentToken:s}=this;if(this.currentToken=null!==(t=e.userToken)&&void 0!==t?t:null,void 0===s||r.isIdentificationEvent(e.event))return[e];let a=null!==(n=null==s?void 0:s.getSubject())&&void 0!==n?n:null,u=null!==(o=null===(i=e.userToken)||void 0===i?void 0:i.getSubject())&&void 0!==o?o:null;if(u===a)return[e];let c=[];return null!==s&&null!==a&&(this.logger.info("External user sign out automatically tracked"),c.push({timestamp:e.timestamp,context:e.context,userToken:s,event:{type:"userSignedOut",userId:a}})),null!==u&&(this.logger.info("External user sign in automatically tracked"),c.push({timestamp:e.timestamp,context:e.context,userToken:e.userToken,event:{type:"userSignedIn",userId:u}})),c.push(e),c}static isIdentificationEvent(e){switch(e.type){case"userSignedIn":case"userSignedUp":case"userSignedOut":return!0;default:return!1}}}t.EventSubjectProcessor=r},89332:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ContentFetcherFacade=void 0;let n=r(66913),i=r(78004);class o{constructor(e){this.fetcher=e.contentFetcher,this.previewTokenProvider=e.previewTokenProvider,this.userTokenProvider=e.userTokenProvider,this.cidAssigner=e.cidAssigner,this.contextFactory=e.contextFactory}async fetch(e,t={}){var r,o;if("string"!=typeof e||0===e.length)throw Error("The slot ID must be a non-empty string.");return!function(e){try{i.fetchOptionsSchema.validate(e)}catch(e){throw Error(`Invalid options: ${(0,n.formatCause)(e)}`)}}(t),this.fetcher.fetch(e,{static:!1,clientId:await this.cidAssigner.assignCid(),userToken:null!==(r=this.userTokenProvider.getToken())&&void 0!==r?r:void 0,previewToken:null!==(o=this.previewTokenProvider.getToken())&&void 0!==o?o:void 0,version:t.version,context:this.contextFactory.createContext(t.attributes),timeout:t.timeout,preferredLocale:t.preferredLocale})}}t.ContentFetcherFacade=o},72156:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TabContextFactory=t.MinimalContextFactory=t.EvaluatorFacade=void 0;let n=r(78004),i=r(66913);class o{constructor(e){this.evaluator=e.evaluator,this.contextFactory=e.contextFactory,this.tokenProvider=e.userTokenProvider,this.cidAssigner=e.cidAssigner}async evaluate(e,t={}){var r;if("string"!=typeof e||0===e.length)throw Error("The query must be a non-empty string.");return!function(e){try{n.evaluationOptionsSchema.validate(e)}catch(e){throw Error(`Invalid options: ${(0,i.formatCause)(e)}`)}}(t),this.evaluator.evaluate(e,{clientId:await this.cidAssigner.assignCid(),userToken:null!==(r=this.tokenProvider.getToken())&&void 0!==r?r:void 0,timeout:t.timeout,context:this.contextFactory.createContext(t.attributes)})}}t.EvaluatorFacade=o;class s{createContext(e){return void 0===e?{}:{attributes:e}}}t.MinimalContextFactory=s;class a{constructor(e){this.tab=e}createContext(e){var t;let r=new URL(this.tab.url),n={},i={title:this.tab.title,url:r.toString()},{referrer:o}=this.tab;o.length>0&&(i.referrer=o),n.page=i;let s=null!==(t=Intl.DateTimeFormat().resolvedOptions().timeZone)&&void 0!==t?t:null;return null!==s&&(n.timeZone=s),void 0!==e&&Object.keys(e).length>0&&(n.attributes=e),n}}t.TabContextFactory=a},88103:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SdkFacade=void 0;let n=r(72156),i=r(86513),o=r(13525),s=r(63963),a=r(66913),u=r(78004),c=r(52487),l=r(67660),d=r(89332),h=r(69530);class p{constructor(e){this.sdk=e}static init(e){var t,r,n,i,o;!function(e){try{u.sdkFacadeConfigurationSchema.validate(e)}catch(e){throw Error(`Invalid configuration: ${(0,a.formatCause)(e)}`)}}(e);let{track:l=!0,userId:d,token:f,...g}=e;if(void 0!==d&&void 0!==f)throw Error("Either the user ID or token can be specified, but not both.");let y=new p(c.Sdk.init({...g,tokenScope:null!==(t=g.tokenScope)&&void 0!==t?t:"global",debug:null!==(r=g.debug)&&void 0!==r&&r,test:null!==(n=g.test)&&void 0!==n&&n,disableCidMirroring:null!==(i=g.disableCidMirroring)&&void 0!==i&&i,eventProcessor:e=>new h.EventSubjectProcessor(e.getLogger("EventSubjectProcessor"))}));if(void 0!==d){let e=y.context.getToken(),t=null!==(o=null==e?void 0:e.getSubject())&&void 0!==o?o:null;t!==d&&(null===d?y.unsetToken():y.identify(d))}else void 0!==f&&(null===f?y.unsetToken():y.setToken(s.Token.parse(f)));return l&&y.tracker.enable(),y}get context(){return this.sdk.context}get cidAssigner(){return this.sdk.cidAssigner}get previewTokenStore(){return this.sdk.previewTokenStore}get userTokenStore(){return this.sdk.userTokenStore}get tracker(){return void 0===this.trackerFacade&&(this.trackerFacade=new i.TrackerFacade(this.sdk.tracker)),this.trackerFacade}get user(){return void 0===this.userFacade&&(this.userFacade=new o.UserFacade(this.context,this.sdk.tracker)),this.userFacade}get session(){return void 0===this.sessionFacade&&(this.sessionFacade=new l.SessionFacade(this.sdk.tracker)),this.sessionFacade}get evaluator(){return void 0===this.evaluatorFacade&&(this.evaluatorFacade=new n.EvaluatorFacade({evaluator:this.sdk.evaluator,contextFactory:new n.TabContextFactory(this.sdk.context.getTab()),cidAssigner:this.sdk.cidAssigner,userTokenProvider:this.sdk.userTokenStore})),this.evaluatorFacade}get contentFetcher(){return void 0===this.contentFetcherFacade&&(this.contentFetcherFacade=new d.ContentFetcherFacade({contentFetcher:this.sdk.contentFetcher,contextFactory:new n.TabContextFactory(this.sdk.context.getTab()),cidAssigner:this.sdk.cidAssigner,previewTokenProvider:this.sdk.previewTokenStore,userTokenProvider:this.sdk.userTokenStore})),this.contentFetcherFacade}get eventManager(){let{eventManager:e}=this.sdk;return{addListener:e.addListener.bind(e),removeListener:e.removeListener.bind(e),dispatch:(t,r)=>{if(!/[a-z][a-z_]+\.[a-z][a-z_]+/i.test(t))throw Error('The event name must be in the form of "namespaced.eventName", where both the namespace and event name must start with a letter, followed by any series of letters and underscores.');e.dispatch(t,r)}}}identify(e){this.setToken(s.Token.issue(this.sdk.appId,e))}anonymize(){this.context.isAnonymous()||this.unsetToken()}getToken(){return this.context.getToken()}setToken(e){var t;let r=this.getToken();if(null!==r&&r.toString()===e.toString())return;let n=null!==(t=null==r?void 0:r.getSubject())&&void 0!==t?t:null,i=e.getSubject(),o=this.getLogger();if(i===n){this.context.setToken(e),o.debug("Token refreshed");return}null!==n&&(this.trackInternalEvent({type:"userSignedOut",userId:n}),o.info("User signed out")),this.context.setToken(e),null!==i&&(this.trackInternalEvent({type:"userSignedIn",userId:i}),o.info(`User signed in as ${i}`)),o.debug("New token saved, ")}unsetToken(){let e=this.getToken();if(null===e)return;let t=this.getLogger(),r=e.getSubject();null!==r&&(this.trackInternalEvent({type:"userSignedOut",userId:r}),t.info("User signed out")),this.context.setToken(null),t.debug("Token removed")}trackInternalEvent(e){this.sdk.tracker.track(e).catch(()=>{})}getLogger(...e){return this.sdk.getLogger(...e)}getTabStorage(e,...t){return this.sdk.getTabStorage(e,...t)}getBrowserStorage(e,...t){return this.sdk.getBrowserStorage(e,...t)}close(){return this.sdk.close()}}t.SdkFacade=p},67660:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SessionFacade=void 0;let n=r(1541);class i{constructor(e){this.tracker=e}edit(){return new n.SessionPatch(this.tracker)}}t.SessionFacade=i},1541:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SessionPatch=void 0;let n=r(85974);class i extends n.ActiveRecord{constructor(e){super(),this.tracker=e}save(){if(!this.isDirty())return Promise.resolve({type:"sessionAttributesChanged",patch:{operations:[]}});let e=this.tracker.track({type:"sessionAttributesChanged",patch:this.buildPatch()});return this.reset(),e}}t.SessionPatch=i},86513:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TrackerFacade=void 0;let n=r(66913),i=r(78004),o={cartViewed:i.cartViewed,cartModified:i.cartModified,checkoutStarted:i.checkoutStarted,orderPlaced:i.orderPlaced,productViewed:i.productViewed,userSignedUp:i.userSignedUp,eventOccurred:i.eventOccurred,interestShown:i.interestShown,postViewed:i.postViewed,goalCompleted:i.goalCompleted,linkOpened:i.linkOpened};class s{constructor(e){this.tracker=e}get flushed(){return this.tracker.flushed}enable(){this.tracker.enable()}disable(){this.tracker.disable()}addListener(e){this.tracker.addListener(e)}removeListener(e){this.tracker.removeListener(e)}track(e,t){return this.tracker.track(function(e,t){if("string"!=typeof e)throw Error("The event type must of type string.");if("object"!=typeof t||null==t)throw Error("The event payload must of type object.");let r={type:e,...t};return!function(e){let{type:t,...r}=e;if(!(t in o))throw Error(`Unknown event type '${t}'.`);try{o[t].validate(r)}catch(e){throw Error(`Invalid event payload: ${(0,n.formatCause)(e)}`)}}(r),r}(e,t))}}t.TrackerFacade=s},13525:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UserFacade=void 0;let n=r(43068);class i{constructor(e,t){this.context=e,this.tracker=t}isIdentified(){return!this.isAnonymous()}isAnonymous(){return this.context.isAnonymous()}edit(){return new n.UserPatch(this.tracker)}}t.UserFacade=i},43068:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UserPatch=void 0;let n=r(85974);class i extends n.ActiveRecord{constructor(e){super(),this.tracker=e}save(){if(!this.isDirty())return Promise.resolve({type:"userProfileChanged",patch:{operations:[]}});let e=this.tracker.track({type:"userProfileChanged",patch:this.buildPatch()});return this.reset(),e}}t.UserPatch=i},31341:function(e,t){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.Help=void 0,(r||(t.Help=r={})).forStatusCode=function(e){switch(e){case 401:return"The request was not authorized, most likely due to invalid credentials. For help, see https://croct.help/sdk/javascript/invalid-credentials";case 403:return"The origin of the request is not allowed in your application settings. For help, see https://croct.help/sdk/javascript/unauthorized-origin";case 408:return"The request timed out. For help, see https://croct.help/sdk/javascript/request-timeout";case 423:return"The application has exceeded the monthly active users (MAU) quota. For help, see https://croct.help/sdk/javascript/mau-exceeded";default:return}}},79402:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.VERSION=t.Sdk=void 0;let n=r(54776);Object.defineProperty(t,"VERSION",{enumerable:!0,get:function(){return n.VERSION}});let i=r(52487);Object.defineProperty(t,"Sdk",{enumerable:!0,get:function(){return i.Sdk}})},45294:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ConsoleLogger=void 0;class r{constructor(e){this.namespace=e}get debug(){return this.bind(console.debug)}get info(){return this.bind(console.info)}get warn(){return this.bind(console.warn)}get error(){return this.bind(console.error)}bind(e){return void 0!==this.namespace?e.bind(console,`[${this.namespace}]`):e.bind(console)}}t.ConsoleLogger=r},54638:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FilteredLogger=void 0;class r{constructor(e){this.logger=e.logger,this.allowFilter=e.allowFilter}static include(e,t){return new r({logger:e,allowFilter:e=>t.includes(e)})}static exclude(e,t){return new r({logger:e,allowFilter:e=>!t.includes(e)})}debug(e){this.log("debug",e)}info(e){this.log("info",e)}warn(e){this.log("warn",e)}error(e){this.log("error",e)}log(e,t){this.allowFilter(e,t)&&this.logger[e](t)}}t.FilteredLogger=r},4592:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FilteredLogger=t.NullLogger=t.NamespacedLogger=t.ConsoleLogger=void 0;let n=r(99094);n.__exportStar(r(39697),t);var i=r(45294);Object.defineProperty(t,"ConsoleLogger",{enumerable:!0,get:function(){return i.ConsoleLogger}});var o=r(44017);Object.defineProperty(t,"NamespacedLogger",{enumerable:!0,get:function(){return o.NamespacedLogger}});var s=r(36415);Object.defineProperty(t,"NullLogger",{enumerable:!0,get:function(){return s.NullLogger}});var a=r(54638);Object.defineProperty(t,"FilteredLogger",{enumerable:!0,get:function(){return a.FilteredLogger}})},39697:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},44017:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NamespacedLogger=void 0;class r{constructor(e,t){this.logger=e,this.namespace=t}debug(e){this.logger.debug(this.format(e))}info(e){this.logger.info(this.format(e))}warn(e){this.logger.warn(this.format(e))}error(e){this.logger.error(this.format(e))}format(e){return`[${this.namespace}] ${e}`}}t.NamespacedLogger=r},36415:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NullLogger=void 0;class r{debug(){}info(){}warn(){}error(){}}t.NullLogger=r},63690:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NamespacedStorage=void 0;class r{constructor(e,t){if(""===t)throw Error("The namespace cannot be empty.");this.storage=e,this.namespace=t}get length(){return this.getKeys().length}clear(){for(let e of this.getKeys())this.storage.removeItem(e)}getItem(e){return this.storage.getItem(this.getPrefixedKey(e))}key(e){let t=this.getKeys();return e>=t.length?null:t[e].substring(this.namespace.length+1)}removeItem(e){this.storage.removeItem(this.getPrefixedKey(e))}setItem(e,t){this.storage.setItem(this.getPrefixedKey(e),t)}getKeys(){let e=[],t=this.getPrefix();for(let r=0;r<this.storage.length;r++){let n=this.storage.key(r);null!==n&&0===n.indexOf(t)&&e.push(n)}return e}getPrefixedKey(e){return this.getPrefix()+e}getPrefix(){return`${this.namespace}.`}}t.NamespacedStorage=r},13894:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CapacityRestrictedQueue=void 0;class r{constructor(e,t){this.queue=e,this.capacity=t}all(){return this.queue.all()}getCapacity(){return this.capacity}isEmpty(){return this.queue.isEmpty()}length(){return Math.min(this.capacity,this.queue.length())}peek(){return this.queue.peek()}push(e){if(this.queue.length()>=this.capacity)throw Error("Maximum queue capacity reached.");this.queue.push(e)}shift(){return this.queue.shift()}}t.CapacityRestrictedQueue=r},88627:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.InMemoryQueue=void 0;class r{constructor(...e){this.queue=[],this.queue.unshift(...e)}all(){return this.queue.slice()}getCapacity(){return 1/0}isEmpty(){return 0===this.queue.length}push(e){this.queue.push(e)}peek(){var e;return null!==(e=this.queue[0])&&void 0!==e?e:null}shift(){let e=this.queue.shift();if(void 0===e)throw Error("The queue is empty.");return e}length(){return this.queue.length}}t.InMemoryQueue=r},55940:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PersistentQueue=t.MonitoredQueue=t.InMemoryQueue=t.CapacityRestrictedQueue=void 0;let n=r(99094);n.__exportStar(r(74584),t);var i=r(13894);Object.defineProperty(t,"CapacityRestrictedQueue",{enumerable:!0,get:function(){return i.CapacityRestrictedQueue}});var o=r(88627);Object.defineProperty(t,"InMemoryQueue",{enumerable:!0,get:function(){return o.InMemoryQueue}});var s=r(94068);Object.defineProperty(t,"MonitoredQueue",{enumerable:!0,get:function(){return s.MonitoredQueue}});var a=r(69308);Object.defineProperty(t,"PersistentQueue",{enumerable:!0,get:function(){return a.PersistentQueue}})},94068:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MonitoredQueue=void 0;let n=r(4592);class i{constructor(e,t){this.callbacks={},this.queue=e,this.logger=null!=t?t:new n.NullLogger,this.updateStatus()}all(){return this.queue.all()}getCapacity(){return this.queue.getCapacity()}addCallback(e,t){var r;let n=null!==(r=this.callbacks[e])&&void 0!==r?r:[];switch(n.includes(t)||n.push(t),this.callbacks[e]=n,this.status){case e:t(this);break;case"empty":case"almostEmpty":"halfEmpty"===e&&t(this);break;case"full":case"almostFull":"halfFull"===e&&t(this)}}removeCallback(e,t){let r=this.callbacks[e];if(null==r)return;let n=r.indexOf(t);n>=0&&r.splice(n,1)}setStatus(e){this.status!==e&&(this.logger.debug(`Queue status changed to "${e}"`),this.report(e),this.status=e)}report(e){let t=this.callbacks[e];switch(void 0!==t&&t.forEach(e=>e(this)),e){case"empty":case"almostEmpty":this.report("halfEmpty");break;case"full":case"almostFull":this.report("halfFull")}}isEmpty(){return this.queue.isEmpty()}length(){return this.queue.length()}peek(){return this.queue.peek()}push(e){this.queue.push(e),this.updateStatus()}shift(){let e=this.queue.shift();return this.updateStatus(),e}updateStatus(){let e=this.queue.length(),t=this.getCapacity();if(e<=.5*t){0===e?this.setStatus("empty"):e<=.25*t?this.setStatus("almostEmpty"):this.setStatus("halfEmpty");return}e>=t?this.setStatus("full"):e>=.75*t?this.setStatus("almostFull"):this.setStatus("halfFull")}}t.MonitoredQueue=i},69308:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PersistentQueue=void 0;class r{constructor(e,t="queue"){this.storage=e,this.key=t}all(){return this.queue.slice()}getCapacity(){return Number.MAX_SAFE_INTEGER}isEmpty(){return 0===this.length()}length(){return this.queue.length}push(e){this.save([...this.queue,e])}peek(){let e=this.queue[0];return void 0===e?null:e}shift(){let e=[...this.queue],t=e.shift();if(void 0===t)throw Error("The queue is empty.");return this.save(e),t}get queue(){let e=this.storage.getItem(this.key);if(null===e)return[];try{return JSON.parse(e)}catch{return[]}}save(e){this.storage.setItem(this.key,JSON.stringify(e))}}t.PersistentQueue=r},74584:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},89406:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ArbitraryPolicy=void 0;class r{constructor(e){if(e.length<1)throw Error("The list of delays cannot be empty.");this.delays=[...e]}getDelay(e){return this.delays[Math.min(e<0?0:e,this.delays.length-1)]}shouldRetry(){return!0}}t.ArbitraryPolicy=r},98887:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BackoffPolicy=void 0;class r{constructor(e={}){this.minRetryDelay=1e3,this.maxRetryDelay=3e4,this.backoffFactor=2,this.backoffJitter=1,this.maxAttempts=1/0;let{minRetryDelay:t=this.minRetryDelay,maxRetryDelay:r=this.maxRetryDelay,backoffFactor:n=this.backoffFactor,backoffJitter:i=this.backoffJitter,maxAttempts:o=this.maxAttempts}=e;if(t<0)throw Error("The minimum retry delay must be non-negative.");if(r<t)throw Error("The maximum retry delay must be greater than the minimum.");if(n<1)throw Error("The backoff factor must be greater than zero.");if(i<0)throw Error("The backoff jitter must be non-negative.");if(o<0)throw Error("The maximum attempts must be non-negative.");this.minRetryDelay=t,this.maxRetryDelay=r,this.backoffFactor=n,this.backoffJitter=i,this.maxAttempts=o}getDelay(e){let t=Math.min(Math.max(this.backoffFactor**e,this.minRetryDelay),this.maxRetryDelay);if(this.backoffJitter>0){let e=Math.ceil(this.minRetryDelay),r=Math.floor(t);t=Math.floor(Math.random()*(r-e+1))+e}return t-t%1}shouldRetry(e){return e<this.maxAttempts}}t.BackoffPolicy=r},19604:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NeverPolicy=t.MaxAttemptsPolicy=t.BackoffPolicy=t.ArbitraryPolicy=void 0;let n=r(99094);n.__exportStar(r(15328),t);var i=r(89406);Object.defineProperty(t,"ArbitraryPolicy",{enumerable:!0,get:function(){return i.ArbitraryPolicy}});var o=r(98887);Object.defineProperty(t,"BackoffPolicy",{enumerable:!0,get:function(){return o.BackoffPolicy}});var s=r(78633);Object.defineProperty(t,"MaxAttemptsPolicy",{enumerable:!0,get:function(){return s.MaxAttemptsPolicy}});var a=r(69289);Object.defineProperty(t,"NeverPolicy",{enumerable:!0,get:function(){return a.NeverPolicy}})},78633:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MaxAttemptsPolicy=void 0;class r{constructor(e,t){if(e<0)throw Error("Delay must be non-negative.");if(t<0)throw Error("Max attempts must be non-negative.");this.maxAttempts=t,this.delay=e}getDelay(){return this.delay}shouldRetry(e){return e<this.maxAttempts}}t.MaxAttemptsPolicy=r},69289:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NeverPolicy=void 0;class r{getDelay(){return 1/0}shouldRetry(){return!1}}t.NeverPolicy=r},15328:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},52139:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.attributeNameSchema=void 0;let n=r(27346);t.attributeNameSchema=new n.StringType({maxLength:50,format:"identifier"})},91493:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fetchOptionsSchema=void 0;let n=r(27346);t.fetchOptionsSchema=new n.ObjectType({properties:{timeout:new n.NumberType({integer:!0,minimum:0}),version:new n.UnionType(new n.StringType({pattern:/^\d+$/}),new n.NumberType({integer:!0,minimum:1})),preferredLocale:new n.StringType({pattern:/^[a-z]{2,3}([-_][a-z]{2,3})?$/i}),attributes:new n.JsonObjectType}})},24201:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.postDetails=void 0;let n=r(27346);t.postDetails=new n.ObjectType({required:["postId","title","publishTime"],properties:{postId:new n.StringType({minLength:1,maxLength:200}),url:new n.StringType({format:"url"}),title:new n.StringType({minLength:1,maxLength:200}),tags:new n.ArrayType({items:new n.StringType({minLength:1,maxLength:50}),minItems:1,maxItems:10}),categories:new n.ArrayType({items:new n.StringType({minLength:1,maxLength:50}),minItems:1,maxItems:10}),authors:new n.ArrayType({items:new n.StringType({minLength:1,maxLength:50}),minItems:1,maxItems:10}),publishTime:new n.NumberType,updateTime:new n.NumberType}})},41165:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.tokenScopeSchema=void 0;let n=r(27346);t.tokenScopeSchema=new n.StringType({enumeration:["global","contextual","isolated"]})},36400:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.order=t.orderItem=t.cart=t.cartItem=t.productDetails=void 0;let n=r(27346);t.productDetails=new n.ObjectType({required:["productId","name","displayPrice"],properties:{productId:new n.StringType({minLength:1,maxLength:50}),sku:new n.StringType({minLength:1,maxLength:50}),name:new n.StringType({minLength:1,maxLength:200}),category:new n.StringType({minLength:1,maxLength:100}),brand:new n.StringType({minLength:1,maxLength:100}),variant:new n.StringType({minLength:1,maxLength:50}),displayPrice:new n.NumberType({minimum:0}),originalPrice:new n.NumberType({minimum:0}),url:new n.StringType({format:"url"}),imageUrl:new n.StringType({format:"url"})}}),t.cartItem=new n.ObjectType({required:["index","product","quantity","total"],properties:{index:new n.NumberType({minimum:0}),product:t.productDetails,quantity:new n.NumberType({minimum:1}),total:new n.NumberType({minimum:0}),discount:new n.NumberType({minimum:0}),coupon:new n.StringType({minLength:1,maxLength:50})}}),t.cart=new n.ObjectType({required:["currency","items","total"],properties:{currency:new n.StringType({maxLength:10,minLength:1}),items:new n.ArrayType({items:t.cartItem}),subtotal:new n.NumberType({minimum:0}),shippingPrice:new n.NumberType({minimum:0}),taxes:new n.ObjectType({additionalProperties:new n.NumberType,minProperties:1}),costs:new n.ObjectType({additionalProperties:new n.NumberType,minProperties:1}),discount:new n.NumberType({minimum:0}),total:new n.NumberType({minimum:0}),coupon:new n.StringType({minLength:1,maxLength:50}),lastUpdateTime:new n.NumberType}}),t.orderItem=new n.ObjectType({required:["index","product","quantity","total"],properties:{index:new n.NumberType({minimum:0}),product:t.productDetails,quantity:new n.NumberType({minimum:1}),total:new n.NumberType({minimum:0}),discount:new n.NumberType({minimum:0}),coupon:new n.StringType({minLength:1,maxLength:50})}}),t.order=new n.ObjectType({required:["orderId","currency","items","total"],properties:{orderId:new n.StringType({minLength:1,maxLength:50}),currency:new n.StringType({maxLength:10,minLength:1}),items:new n.ArrayType({items:t.orderItem,minItems:1}),subtotal:new n.NumberType({minimum:0}),shippingPrice:new n.NumberType({minimum:0}),taxes:new n.ObjectType({additionalProperties:new n.NumberType,minProperties:1}),costs:new n.ObjectType({additionalProperties:new n.NumberType,minProperties:1}),discount:new n.NumberType({minimum:0}),total:new n.NumberType({minimum:0}),coupon:new n.StringType({minLength:1,maxLength:50}),paymentMethod:new n.StringType({minLength:1,maxLength:50}),installments:new n.NumberType({minimum:1}),status:new n.StringType({enumeration:["placed","paid","complete"]})}})},36720:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.evaluationOptionsSchema=void 0;let n=r(27346);t.evaluationOptionsSchema=new n.ObjectType({properties:{timeout:new n.NumberType({integer:!0,minimum:0}),attributes:new n.JsonObjectType}})},93630:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.eventOccurred=t.linkOpened=t.postViewed=t.interestShown=t.goalCompleted=t.userSignedUp=t.productViewed=t.orderPlaced=t.checkoutStarted=t.cartViewed=t.cartModified=void 0;let n=r(27346),i=r(36400),o=r(31279),s=r(24201);t.cartModified=new n.ObjectType({required:["cart"],properties:{cart:i.cart}}),t.cartViewed=new n.ObjectType({required:["cart"],properties:{cart:i.cart}}),t.checkoutStarted=new n.ObjectType({required:["cart"],properties:{cart:i.cart,orderId:new n.StringType({minLength:1,maxLength:50})}}),t.orderPlaced=new n.ObjectType({required:["order"],properties:{order:i.order}}),t.productViewed=new n.ObjectType({required:["product"],properties:{product:i.productDetails}}),t.userSignedUp=new n.ObjectType({required:["userId"],properties:{userId:new n.StringType({minLength:1,maxLength:254}),profile:o.userProfileSchema}}),t.goalCompleted=new n.ObjectType({required:["goalId"],properties:{goalId:new n.StringType({minLength:3,maxLength:100,pattern:/^[a-z0-9][a-z0-9:_-]+[a-z0-9]$/i}),value:new n.NumberType({minimum:0}),currency:new n.StringType({minLength:1,maxLength:10})}}),t.interestShown=new n.ObjectType({required:["interests"],properties:{interests:new n.ArrayType({items:new n.StringType({minLength:1,maxLength:50}),minItems:1,maxItems:10})}}),t.postViewed=new n.ObjectType({required:["post"],properties:{post:s.postDetails}}),t.linkOpened=new n.ObjectType({required:["link"],properties:{link:new n.StringType}}),t.eventOccurred=new n.ObjectType({required:["name"],properties:{name:new n.StringType({minLength:1,maxLength:50}),details:new n.ObjectType({additionalProperties:new n.UnionType(new n.NullType,new n.BooleanType,new n.NumberType,new n.StringType({maxLength:300})),propertyNames:new n.StringType({minLength:1,maxLength:20,format:"identifier"}),maxProperties:10})}})},78004:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=r(99094);n.__exportStar(r(41165),t),n.__exportStar(r(36400),t),n.__exportStar(r(36720),t),n.__exportStar(r(91493),t),n.__exportStar(r(93630),t),n.__exportStar(r(18791),t),n.__exportStar(r(32056),t),n.__exportStar(r(94910),t),n.__exportStar(r(69954),t),n.__exportStar(r(92359),t),n.__exportStar(r(31279),t)},18791:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.loggerSchema=void 0;let n=r(27346);t.loggerSchema=new n.ObjectType({required:["debug","info","warn","error"],additionalProperties:!0,properties:{debug:new n.FunctionType,info:new n.FunctionType,warn:new n.FunctionType,error:new n.FunctionType}})},32056:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.removeOperation=t.unsetOperation=t.clearOperation=t.incrementOperation=t.decrementOperation=t.mergeOperation=t.combineOperation=t.setOperation=t.addOperation=void 0;let n=r(27346),i=r(52139),o=new n.StringType({format:"pointer"}),s=new n.JsonArrayType({items:new n.JsonPrimitiveType}),a=new n.JsonObjectType({properties:new n.JsonPrimitiveType,propertyNames:i.attributeNameSchema}),u=new n.JsonObjectType({properties:new n.UnionType(new n.JsonPrimitiveType,s,a),propertyNames:i.attributeNameSchema}),c=new n.UnionType(s,u),l=new n.UnionType(new n.JsonPrimitiveType,s,u);t.addOperation=new n.ObjectType({required:["path","value"],properties:{path:o,value:l}}),t.setOperation=new n.ObjectType({required:["path","value"],properties:{path:o,value:l}}),t.combineOperation=new n.ObjectType({required:["path","value"],properties:{path:o,value:l}}),t.mergeOperation=new n.ObjectType({required:["path","value"],properties:{path:o,value:c}}),t.decrementOperation=new n.ObjectType({required:["path","value"],properties:{path:o,value:new n.NumberType}}),t.incrementOperation=new n.ObjectType({required:["path","value"],properties:{path:o,value:new n.NumberType}}),t.clearOperation=new n.ObjectType({required:["path"],properties:{path:o}}),t.unsetOperation=new n.ObjectType({required:["path"],properties:{path:o}}),t.removeOperation=new n.ObjectType({required:["path","value"],properties:{path:o,value:l}})},94910:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.sdkFacadeConfigurationSchema=void 0;let n=r(27346),i=r(41165),o=r(69954),s=r(18791);t.sdkFacadeConfigurationSchema=new n.ObjectType({required:["appId"],properties:{appId:new n.StringType({format:"uuid"}),clientId:new n.StringType({pattern:/^[0-9a-f]{32}$/i}),tokenScope:i.tokenScopeSchema,disableCidMirroring:new n.BooleanType,debug:new n.BooleanType,test:new n.BooleanType,track:new n.BooleanType,logger:s.loggerSchema,urlSanitizer:new n.FunctionType,eventMetadata:o.eventMetadataSchema,userId:new n.UnionType(new n.StringType({minLength:1}),new n.NullType),token:new n.UnionType(new n.StringType({pattern:/^[A-Za-z0-9-_=]+\.[A-Za-z0-9-_=]+\.?[A-Za-z0-9-_.+/=]*$/}),new n.NullType),baseEndpointUrl:new n.StringType({format:"url"}),cidAssignerEndpointUrl:new n.StringType({format:"url"}),cookie:new n.ObjectType({properties:{clientId:o.cookieOptionsSchema,userToken:o.cookieOptionsSchema,previewToken:o.cookieOptionsSchema}}),defaultFetchTimeout:new n.NumberType({integer:!0,minimum:1}),defaultPreferredLocale:new n.StringType({pattern:/^[a-z]{2,3}([-_][a-z]{2,3})?$/i})}})},69954:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.sdkConfigurationSchema=t.cookieOptionsSchema=t.eventMetadataSchema=void 0;let n=r(27346),i=r(41165),o=r(18791);t.eventMetadataSchema=new n.ObjectType({maxProperties:5,propertyNames:new n.StringType({minLength:1,maxLength:20,format:"identifier"}),additionalProperties:new n.StringType({maxLength:300})}),t.cookieOptionsSchema=new n.ObjectType({required:["name"],properties:{name:new n.StringType({minLength:1}),domain:new n.StringType({minLength:1}),path:new n.StringType({minLength:1}),secure:new n.BooleanType,sameSite:new n.StringType({enumeration:["strict","lax","none"]}),maxAge:new n.NumberType({minimum:0,integer:!0})}}),t.sdkConfigurationSchema=new n.ObjectType({required:["appId","tokenScope","disableCidMirroring","debug","test"],properties:{appId:new n.StringType({format:"uuid"}),clientId:new n.StringType({pattern:/^[0-9a-f]{32}$/i}),tokenScope:i.tokenScopeSchema,baseEndpointUrl:new n.StringType({format:"url"}),cidAssignerEndpointUrl:new n.StringType({format:"url"}),beaconQueueSize:new n.NumberType({minimum:0,integer:!0}),disableCidMirroring:new n.BooleanType,cookie:new n.ObjectType({properties:{clientId:t.cookieOptionsSchema,userToken:t.cookieOptionsSchema,previewToken:t.cookieOptionsSchema}}),debug:new n.BooleanType,test:new n.BooleanType,logger:o.loggerSchema,urlSanitizer:new n.FunctionType,eventMetadata:t.eventMetadataSchema,eventProcessor:new n.FunctionType,defaultFetchTimeout:new n.NumberType({integer:!0,minimum:1}),defaultPreferredLocale:new n.StringType({pattern:/^[a-z]{2,3}([-_][a-z]{2,3})?$/i})}})},92359:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.tokenSchema=void 0;let n=r(27346);t.tokenSchema=new n.ObjectType({required:["headers","payload"],properties:{headers:new n.ObjectType({required:["typ","alg"],properties:{typ:new n.StringType,alg:new n.StringType,kid:new n.StringType,appId:new n.StringType({format:"uuid"})}}),payload:new n.ObjectType({required:["iss","aud","iat"],properties:{iss:new n.StringType,aud:new n.UnionType(new n.StringType,new n.ArrayType({items:new n.StringType})),iat:new n.NumberType({minimum:0}),sub:new n.StringType({minLength:1}),exp:new n.NumberType({minimum:0}),jti:new n.StringType({format:"uuid"})},additionalProperties:!0}),signature:new n.StringType}})},31279:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.userProfileSchema=void 0;let n=r(27346),i=r(52139);t.userProfileSchema=new n.ObjectType({properties:{firstName:new n.StringType({minLength:1,maxLength:50}),lastName:new n.StringType({minLength:1,maxLength:50}),birthDate:new n.StringType({format:"date"}),gender:new n.StringType({enumeration:["male","female","neutral","unknown"]}),email:new n.StringType({minLength:1,maxLength:254}),alternateEmail:new n.StringType({minLength:1,maxLength:254}),phone:new n.StringType({minLength:1,maxLength:30}),alternatePhone:new n.StringType({minLength:1,maxLength:30}),address:new n.ObjectType({properties:{street:new n.StringType({minLength:1,maxLength:100}),district:new n.StringType({minLength:1,maxLength:100}),city:new n.StringType({minLength:1,maxLength:100}),region:new n.StringType({minLength:1,maxLength:100}),country:new n.StringType({minLength:1,maxLength:100}),postalCode:new n.StringType({minLength:1,maxLength:20})}}),avatar:new n.StringType({maxLength:500,format:"url"}),company:new n.StringType({minLength:1,maxLength:200}),companyUrl:new n.StringType({maxLength:200,format:"url"}),jobTitle:new n.StringType({minLength:1,maxLength:50}),interests:new n.ArrayType({maxItems:30,items:new n.StringType({minLength:1,maxLength:30})}),activities:new n.ArrayType({maxItems:30,items:new n.StringType({minLength:1,maxLength:30})}),custom:new n.ObjectType({propertyNames:i.attributeNameSchema,maxProperties:10,additionalProperties:new n.UnionType(new n.BooleanType,new n.NullType,new n.NumberType,new n.StringType({maxLength:100}),new n.ArrayType({maxItems:10,items:new n.UnionType(new n.BooleanType,new n.NullType,new n.NumberType,new n.StringType({maxLength:100}),new n.ArrayType({maxItems:10,items:new n.UnionType(new n.BooleanType,new n.NullType,new n.NumberType,new n.StringType({maxLength:100}))}),new n.ObjectType({propertyNames:i.attributeNameSchema,maxProperties:10,additionalProperties:new n.UnionType(new n.BooleanType,new n.NullType,new n.NumberType,new n.StringType({maxLength:100}))}))}),new n.ObjectType({propertyNames:i.attributeNameSchema,maxProperties:10,additionalProperties:new n.UnionType(new n.BooleanType,new n.NullType,new n.NumberType,new n.StringType({maxLength:100}),new n.ArrayType({maxItems:10,items:new n.UnionType(new n.BooleanType,new n.NullType,new n.NumberType,new n.StringType({maxLength:100}))}),new n.ObjectType({propertyNames:i.attributeNameSchema,maxProperties:10,additionalProperties:new n.UnionType(new n.BooleanType,new n.NullType,new n.NumberType,new n.StringType({maxLength:100}))}))}))})}})},52487:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Sdk=void 0;let n=r(12880),i=r(54776),o=r(78004),s=r(66913);class a{constructor(e){this.container=e}static init(e){var t;!function(e){if("object"!=typeof e||null===e)throw Error("The configuration must be a key-value map.");try{o.sdkConfigurationSchema.validate(e)}catch(e){throw Error(`Invalid configuration: ${(0,s.formatCause)(e)}`)}}(e);let{eventMetadata:r={},baseEndpointUrl:u=i.BASE_ENDPOINT_URL,cidAssignerEndpointUrl:c,...l}=e,d={sdkVersion:i.VERSION};for(let e of Object.keys(r))d[`custom_${e}`]=r[e];let h=u.replace(/\/+$/,""),p=new n.Container({...l,evaluationBaseEndpointUrl:h,contentBaseEndpointUrl:h,trackerEndpointUrl:`${h}/client/web/track`,cidAssignerEndpointUrl:null!=c?c:`${h}/client/web/cid`,beaconQueueSize:null!==(t=l.beaconQueueSize)&&void 0!==t?t:100,eventMetadata:d}),f=p.getLogger(),{appId:g,tokenScope:y}=p.getConfiguration();f.debug("\n\n     \n\n                \n                \n      \n\n"),f.info(`Initializing SDK v${i.VERSION}...`),f.debug(`App ID: ${g}`);let m=p.getContext(),v=m.getTab(),b=m.getUser();return f.debug(`${v.isNew?"New":"Current"} tab: ${v.id}`),f.debug(`Token scope: ${y}`),f.debug(`Current user: ${null!==b?b:"anonymous"}`),f.debug(`Test mode: ${l.test}`),f.info(" Croct SDK is ready!"),new a(p)}get appId(){let{appId:e}=this.container.getConfiguration();return e}get cidAssigner(){return this.container.getCidAssigner()}get previewTokenStore(){return this.container.getPreviewTokenStore()}get userTokenStore(){return this.container.getUserTokenStore()}get context(){return this.container.getContext()}get tracker(){return this.container.getTracker()}get evaluator(){return this.container.getEvaluator()}get contentFetcher(){return this.container.getContentFetcher()}get eventManager(){return this.container.getEventManager()}getLogger(...e){return this.container.getLogger(...e)}getTabStorage(e,...t){return this.container.getTabStorage(e,...t)}getBrowserStorage(e,...t){return this.container.getBrowserStorage(e,...t)}async close(){if(this.closed)return;let e=this.getLogger();e.debug("Closing SDK..."),this.closed=!0,await this.container.dispose(),e.info("SDK closed.")}}t.Sdk=a},38086:function(e,t){"use strict";function r(e,t,r){let n,i;if(t<0)throw Error("The start index cannot be negative.");if(r<t)throw Error("The end index must greater than or equal to the start index.");let o=[...e],s=1,a=0;for(let e=0;e<o.length;e++){let u=o[e];if(e===t&&(n={index:e,line:s,column:a}),e===r){i={index:e,line:s,column:a};break}"\n"===u?(s+=1,a=0):a+=1}return void 0===n&&(n={index:o.length,line:s,column:a}),void 0===i&&(i={index:o.length,line:s,column:a}),{start:n,end:i}}Object.defineProperty(t,"__esModule",{value:!0}),t.getLength=function(e){return[...e].length},t.getLocation=r,t.getPosition=function(e,t){return r(e,t,t).start}},50351:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Tab=void 0;let n=r(85916),i={focus:"focus",blur:"blur",beforeunload:"unload",DOMContentLoaded:"load",visibilitychange:"visibilityChange"};class o{constructor(e,t,r){this.eventManager=new n.SynchronousEventManager,this.id=e,this.isNew=t,this.urlSanitizer=r,this.initialize()}initialize(){let e=e=>{this.emit(i[e.type],new CustomEvent(i[e.type],{detail:{tab:this}}))};window.addEventListener("focus",e,!0),window.addEventListener("blur",e,!0),window.addEventListener("beforeunload",e,!0),window.addEventListener("DOMContentLoaded",e,!0),document.addEventListener("visibilitychange",()=>{this.emit("visibilityChange",new CustomEvent("visibilityChange",{detail:{tab:this,visible:this.isVisible}}))},!0),o.addUrlChangeListener(e=>{this.emit("urlChange",new CustomEvent("urlChange",{detail:{tab:this,url:this.sanitizeUrl(e)}}))})}get url(){return this.sanitizeUrl(window.location.href)}get title(){return document.title}get referrer(){return""===document.referrer?"":this.sanitizeUrl(document.referrer)}get isVisible(){return"visible"===document.visibilityState}get document(){return document}addListener(e,t){this.eventManager.addListener(e,t)}removeListener(e,t){this.eventManager.removeListener(e,t)}sanitizeUrl(e){let t=window.encodeURI(window.decodeURI(e));return void 0!==this.urlSanitizer?this.urlSanitizer(t).toString():t}emit(e,t){this.eventManager.dispatch(e,t)}static addUrlChangeListener(e){let t=window.location.href,r=()=>{let r=window.location.href;t!==r&&(e(r),t=r)},{pushState:n}=window.history;window.history.pushState=function(...e){let t=n.apply(window.history,e);return r(),t};let{replaceState:i}=window.history;window.history.replaceState=function(...e){let t=i.apply(window.history,e);return r(),t},window.addEventListener("popstate",r,!0)}}t.Tab=o},78273:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CachedTokenStore=void 0;let n=r(45527);class i{constructor(e){this.cache=e}getToken(){let e=this.cache.get();if(null===e)return null;try{return n.Token.parse(e)}catch(e){return null}}setToken(e){if(null===e){this.cache.clear();return}this.cache.put(e.toString())}}t.CachedTokenStore=i},12466:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.InMemoryTokenStore=void 0;class r{constructor(){this.token=null}getToken(){return this.token}setToken(e){this.token=e}}t.InMemoryTokenStore=r},63963:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ReplicatedTokenStore=t.InMemoryTokenStore=t.CachedTokenStore=void 0;let n=r(99094);n.__exportStar(r(45527),t);var i=r(78273);Object.defineProperty(t,"CachedTokenStore",{enumerable:!0,get:function(){return i.CachedTokenStore}});var o=r(12466);Object.defineProperty(t,"InMemoryTokenStore",{enumerable:!0,get:function(){return o.InMemoryTokenStore}});var s=r(46284);Object.defineProperty(t,"ReplicatedTokenStore",{enumerable:!0,get:function(){return s.ReplicatedTokenStore}})},46284:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ReplicatedTokenStore=void 0;class r{constructor(e,t){this.primary=e,this.secondary=t}getToken(){return this.primary.getToken()}setToken(e){this.primary.setToken(e),this.secondary.setToken(e)}}t.ReplicatedTokenStore=r},45527:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FixedTokenProvider=t.Token=void 0;let n=r(78004),i=r(66913),o=r(38999);class s{constructor(e,t,r=""){this.headers=e,this.payload=t,this.signature=r}static issue(e,t=null,r=Math.floor(Date.now()/1e3)){if(r<0)throw Error("The timestamp must be non-negative.");if(""===t)throw Error("The subject must be non-empty.");return new s({typ:"JWT",alg:"none",appId:e},{iss:"croct.io",aud:"croct.io",iat:r,...null!==t?{sub:t}:null})}static parse(e){let t,r;if(""===e)throw Error("The token cannot be empty.");let n=e.split(".",3);if(n.length<2)throw Error("The token is malformed.");try{t=JSON.parse((0,o.base64UrlDecode)(n[0],!0)),r=JSON.parse((0,o.base64UrlDecode)(n[1],!0))}catch(e){throw Error("The token is corrupted.")}return s.of(t,r,n[2])}static of(e,t,r=""){try{n.tokenSchema.validate({headers:e,payload:t,signature:r})}catch(e){throw Error(`The token is invalid: ${(0,i.formatCause)(e)}`)}return new s(e,t,r)}async signedWith(e){let t=await e.getIdentifierHash(),r={...this.headers,kid:t,alg:e.getSigningAlgorithm()},n=(0,o.base64UrlEncode)(JSON.stringify(r),!0),i=(0,o.base64UrlEncode)(JSON.stringify(this.payload),!0),a=await e.sign(`${n}.${i}`);return new s(r,this.payload,(0,o.base64UrlEncode)(a,!1))}isSigned(){return"none"!==this.headers.alg&&""!==this.signature}isSubject(e){return this.getSubject()===e}isAnonymous(){return void 0===this.payload.sub}isValidNow(e=Math.floor(Date.now()/1e3)){let{exp:t,iat:r}=this.payload;return(void 0===t||t>=e)&&r<=e}isNewerThan(e){return this.payload.iat>e.payload.iat}async matchesKeyId(e){return this.headers.kid===await e.getIdentifierHash()}getHeaders(){return{...this.headers}}getPayload(){return{...this.payload}}getSignature(){return this.signature}getApplicationId(){var e;return null!==(e=this.headers.appId)&&void 0!==e?e:null}getAlgorithm(){return this.headers.alg}getType(){return this.headers.typ}getKeyId(){var e;return null!==(e=this.headers.kid)&&void 0!==e?e:null}getSubject(){var e;return null!==(e=this.payload.sub)&&void 0!==e?e:null}getIssueTime(){return this.payload.iat}getExpirationTime(){var e;return null!==(e=this.payload.exp)&&void 0!==e?e:null}getTokenId(){var e;return null!==(e=this.payload.jti)&&void 0!==e?e:null}getAudience(){return this.payload.aud}getIssuer(){return this.payload.iss}withTokenId(e){if(""===e||!s.UUID_PATTERN.test(e))throw Error("The token ID must be a valid UUID.");return new s(this.headers,{...this.payload,jti:e},this.signature)}withDuration(e,t=Math.floor(Date.now()/1e3)){return new s(this.headers,{...this.payload,iat:t,exp:t+e},this.signature)}withAddedHeaders(e){return this.withHeaders({...this.headers,...Object.fromEntries(Object.entries(e).filter(([,e])=>void 0!==e))})}withAddedClaims(e){return this.withPayload({...this.payload,...Object.fromEntries(Object.entries(e).filter(([,e])=>void 0!==e))})}withHeaders(e){return new s(e,this.payload,this.signature)}withPayload(e){return new s(this.headers,e,this.signature)}withSignature(e){return new s(this.headers,this.payload,e)}toJSON(){return this.toString()}toString(){let e=(0,o.base64UrlEncode)(JSON.stringify(this.headers),!0),t=(0,o.base64UrlEncode)(JSON.stringify(this.payload),!0);return`${e}.${t}.${this.signature}`}}t.Token=s,s.UUID_PATTERN=/^[a-f0-9]{8}-([a-f0-9]{4}-){3}[a-f0-9]{12}$/;class a{constructor(e){this.token=e}getToken(){return this.token}}t.FixedTokenProvider=a},56402:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Tracker=void 0;let n=r(4592),i=r(66913),o=r(10073),s={};class a{constructor(e){var t;this.listeners=[],this.pending=[],this.state={enabled:!1,initialized:!1,suspended:!1},this.inactivityTimer={since:0};let{tab:r,tokenProvider:i,channel:o,logger:s,inactivityRetryPolicy:a,...u}=e;this.tab=r,this.tokenProvider=i,this.inactivityRetryPolicy=a,this.channel=o,this.logger=null!=s?s:new n.NullLogger,this.processor=e.processor,this.options={...u,eventMetadata:null!==(t=u.eventMetadata)&&void 0!==t?t:{}},this.enable=this.enable.bind(this),this.disable=this.disable.bind(this),this.suspend=this.suspend.bind(this),this.unsuspend=this.unsuspend.bind(this),this.trackPageLoad=this.trackPageLoad.bind(this),this.trackTabVisibilityChange=this.trackTabVisibilityChange.bind(this),this.trackTabUrlChange=this.trackTabUrlChange.bind(this),this.trackInactivity=this.trackInactivity.bind(this)}addListener(e){this.listeners.push(e)}removeListener(e){let t=this.listeners.indexOf(e);for(;t>=0;)this.listeners.splice(t,1),t=this.listeners.indexOf(e)}get flushed(){let e=()=>{};return Promise.all(this.pending).then(e,e)}isEnabled(){return this.state.enabled}isSuspended(){return this.state.suspended}enable(){!this.state.enabled&&(this.logger.info("Tracker enabled"),this.state.enabled=!0,this.state.suspended||(this.startInactivityTimer(),this.state.initialized||(this.state.initialized=!0,this.initialize()),this.tab.addListener("load",this.trackPageLoad),this.tab.addListener("urlChange",this.trackTabUrlChange),this.tab.addListener("visibilityChange",this.trackTabVisibilityChange)))}disable(){this.state.enabled&&(this.logger.info("Tracker disabled"),this.state.enabled=!1,this.state.suspended||(this.tab.removeListener("load",this.trackPageLoad),this.tab.removeListener("urlChange",this.trackTabUrlChange),this.tab.removeListener("visibilityChange",this.trackTabVisibilityChange),this.stopInactivityTimer()))}suspend(){this.state.suspended||(this.logger.info("Tracker suspended"),this.state.enabled&&(this.disable(),this.state.enabled=!0),this.state.suspended=!0)}unsuspend(){this.state.suspended&&(this.logger.info("Tracker unsuspended"),this.state.suspended=!1,this.state.enabled&&(this.state.enabled=!1,this.enable()))}initialize(){void 0===s[this.tab.id]&&(s[this.tab.id]={});let e=s[this.tab.id];this.tab.isNew&&!e.tabOpened&&(e.tabOpened=!0,this.trackTabOpen({tabId:this.tab.id})),e.pageOpened||(e.pageOpened=!0,this.trackPageOpen({url:this.tab.url,referrer:this.tab.referrer}))}stopInactivityTimer(){void 0!==this.inactivityTimer.id&&(window.clearTimeout(this.inactivityTimer.id),delete this.inactivityTimer.id)}startInactivityTimer(){this.stopInactivityTimer(),this.inactivityTimer.since=Date.now();let e=-1,t=()=>{if(!this.inactivityRetryPolicy.shouldRetry(e+1,this.inactivityTimer.since)){window.clearTimeout(this.inactivityTimer.id);return}e+=1,this.inactivityTimer.id=window.setTimeout(()=>{this.trackInactivity(),t()},this.inactivityRetryPolicy.getDelay(e))};t()}track(e,t=Date.now()){return this.dispatch(this.enrichEvent(e,t),t).then(()=>e)}trackPageOpen({referrer:e,...t}){this.enqueue({type:"pageOpened",...t,...e.length>0?{referrer:e}:{}})}trackPageLoad({detail:{tab:e}}){this.enqueue({type:"pageLoaded",url:e.url,title:e.title,lastModifiedTime:Date.parse(e.document.lastModified)})}trackTabOpen(e){this.enqueue({type:"tabOpened",...e})}trackTabUrlChange({detail:e}){this.enqueue({type:"tabUrlChanged",tabId:e.tab.id,url:e.url})}trackTabVisibilityChange({detail:e}){this.enqueue({type:"tabVisibilityChanged",tabId:e.tab.id,visibility:e.visible?"visible":"hidden"})}trackInactivity(){this.enqueue({type:"nothingChanged",sinceTime:this.inactivityTimer.since})}enqueue(e,t=Date.now()){this.dispatch(e,t).catch(()=>{})}notifyEvent(e){this.listeners.map(t=>t(e))}dispatch(e,t){let r=this.tokenProvider.getToken(),n=this.options.eventMetadata,i={tabId:this.tab.id,url:this.tab.url,...Object.keys(n).length>0?{metadata:n}:{}},o={...null!==r?{userToken:r}:{},event:e,timestamp:t,context:i},s=void 0!==this.processor?this.processor.process(o):[o];s.sort((e,t)=>e.timestamp-t.timestamp);let a=null;for(let e of s){if(e===o){a=this.publish(o);continue}this.publish(e)}return null===a?Promise.reject(Error("Event suppressed.")):a}publish(e){let{event:t}=e;"nothingChanged"!==t.type&&this.stopInactivityTimer();let r={...e,status:"pending"};return this.state.suspended?(this.logger.warn(`Tracker is suspended, ignoring event "${t.type}"`),this.notifyEvent({...r,status:"ignored"}),Promise.reject(Error("The tracker is suspended."))):(this.logger.info(`Tracked event "${t.type}"`),this.notifyEvent(r),new Promise((n,o)=>{let s=this.channel.publish(this.createBeacon(e)).then(()=>{this.logger.debug(`Successfully published event "${t.type}"`),this.notifyEvent({...r,status:"confirmed"}),n(t)},e=>{this.logger.error(`Failed to publish event "${t.type}", reason: ${(0,i.formatCause)(e)}`),this.notifyEvent({...r,status:"failed"}),o(e)});this.pending.push(s),s.finally(()=>{this.pending.splice(this.pending.indexOf(s),1)}),this.state.enabled&&"nothingChanged"!==t.type&&this.startInactivityTimer()}))}enrichEvent(e,t){if((0,o.isCartPartialEvent)(e)){let{cart:{lastUpdateTime:r=t,...n},...i}=e;return{...i,cart:{...n,lastUpdateTime:r}}}return e}createBeacon({event:e,timestamp:t,context:r,userToken:n}){return{timestamp:t,...void 0!==n?{token:n.toString()}:{},context:r,payload:this.enrichBeaconPayload(this.createBeaconPayload(e))}}createBeaconPayload(e){if(!(0,o.isIdentifiedUserEvent)(e))return e;if("userSignedUp"===e.type&&void 0!==e.profile){let{userId:t,profile:r,...n}=e;return{...n,externalUserId:t,patch:{operations:[{type:"merge",path:".",value:r}]}}}let{userId:t,...r}=e;return{...r,externalUserId:t}}enrichBeaconPayload(e){return"linkOpened"===e.type?{...e,link:new URL(e.link,this.tab.url).toString()}:e}}t.Tracker=a},10073:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.eventTypes=t.miscEventTypes=t.userEventTypes=t.identifiedUserEventTypes=t.ecommerceEventTypes=t.cartEventTypes=t.tabEventTypes=t.pageEventTypes=void 0,t.isIdentifiedUserEvent=function(e){return t.identifiedUserEventTypes.includes(e.type)},t.isCartPartialEvent=function(e){return t.cartEventTypes.includes(e.type)},t.pageEventTypes=["pageLoaded","pageOpened"],t.tabEventTypes=["tabOpened","tabUrlChanged","tabVisibilityChanged"],t.cartEventTypes=["cartModified","cartViewed","checkoutStarted"],t.ecommerceEventTypes=[...t.cartEventTypes,"orderPlaced","productViewed"],t.identifiedUserEventTypes=["userSignedIn","userSignedOut","userSignedUp"],t.userEventTypes=[...t.identifiedUserEventTypes,"userProfileChanged"],t.miscEventTypes=["nothingChanged","sessionAttributesChanged","goalCompleted","interestShown","postViewed","eventOccurred","linkOpened"],t.eventTypes=[...t.pageEventTypes,...t.ecommerceEventTypes,...t.userEventTypes,...t.miscEventTypes]},57379:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.encodeJson=void 0,t.encodeJson=function(e){return Promise.resolve(JSON.stringify(e))}},92607:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.uuid4=function(e=!1){let t="";if(e){let e=Date.now().toString(16).padStart(12,"0").substring(0,12);t=`${e.substring(0,8)}-${e.substring(8,12)}`}for(let e=t.length;e<36;e++)switch(e){case 8:case 13:case 18:case 23:t+="-";break;case 14:t+="4";break;default:{let r=16*Math.random()|0;19===e&&(r=3&r|8),t+=r.toString(16)}}return t}},80091:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ArrayType=void 0;let n=r(25020),i=r(34405);class o{constructor(e={}){var t,r;this.definition={...e,minItems:null!==(t=e.minItems)&&void 0!==t?t:-1,maxItems:null!==(r=e.maxItems)&&void 0!==r?r:-1}}getTypes(){return["array"]}isValidType(e){return Array.isArray(e)}validate(e,t=[]){if(!this.isValidType(e))throw new n.Violation(`Expected value of type array at path '${(0,i.formatPath)(t)}', actual ${(0,i.describe)(e)}.`,t,{type:"string"});let{minItems:r,maxItems:o}=this.definition,{length:s}=e;if(r>=0&&r>s)throw new n.Violation(`Expected ${r===o?"exactly":"at least"} ${r} ${1===r?"item":"items"} at path '${(0,i.formatPath)(t)}', actual ${s}.`,t,{limit:r});if(o>=0&&o<s)throw new n.Violation(`Expected ${r===o?"exactly":"at most"} ${o} ${1===o?"item":"items"} at path '${(0,i.formatPath)(t)}', actual ${s}.`,t,{limit:o});if(void 0!==this.definition.items)for(let r=0;r<s;r++)this.definition.items.validate(e[r],t.concat([r.toString()]))}}t.ArrayType=o},59047:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BooleanType=void 0;let n=r(25020),i=r(34405);class o{getTypes(){return["boolean"]}isValidType(e){return"boolean"==typeof e}validate(e,t=[]){if(!this.isValidType(e))throw new n.Violation(`Expected value of type boolean at path '${(0,i.formatPath)(t)}', actual ${(0,i.describe)(e)}.`,t,{type:"boolean"})}}t.BooleanType=o},69438:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FunctionType=void 0;let n=r(25020),i=r(34405);class o{getTypes(){return["function"]}isValidType(e){return"function"==typeof e}validate(e,t=[]){if(!this.isValidType(e))throw new n.Violation(`Expected value of type function at path '${(0,i.formatPath)(t)}', actual ${(0,i.describe)(e)}.`,t,{type:"function"})}}t.FunctionType=o},27346:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UnionType=t.StringType=t.ObjectType=t.NumberType=t.NullType=t.MixedSchema=t.JsonPrimitiveType=t.JsonObjectType=t.JsonArrayType=t.JsonType=t.FunctionType=t.BooleanType=t.ArrayType=void 0;let n=r(99094);n.__exportStar(r(25020),t),n.__exportStar(r(34405),t);var i=r(80091);Object.defineProperty(t,"ArrayType",{enumerable:!0,get:function(){return i.ArrayType}});var o=r(59047);Object.defineProperty(t,"BooleanType",{enumerable:!0,get:function(){return o.BooleanType}});var s=r(69438);Object.defineProperty(t,"FunctionType",{enumerable:!0,get:function(){return s.FunctionType}});var a=r(4835);Object.defineProperty(t,"JsonType",{enumerable:!0,get:function(){return a.JsonType}}),Object.defineProperty(t,"JsonArrayType",{enumerable:!0,get:function(){return a.JsonArrayType}}),Object.defineProperty(t,"JsonObjectType",{enumerable:!0,get:function(){return a.JsonObjectType}}),Object.defineProperty(t,"JsonPrimitiveType",{enumerable:!0,get:function(){return a.JsonPrimitiveType}});var u=r(38088);Object.defineProperty(t,"MixedSchema",{enumerable:!0,get:function(){return u.MixedSchema}});var c=r(74578);Object.defineProperty(t,"NullType",{enumerable:!0,get:function(){return c.NullType}});var l=r(71759);Object.defineProperty(t,"NumberType",{enumerable:!0,get:function(){return l.NumberType}});var d=r(69789);Object.defineProperty(t,"ObjectType",{enumerable:!0,get:function(){return d.ObjectType}});var h=r(79595);Object.defineProperty(t,"StringType",{enumerable:!0,get:function(){return h.StringType}});var p=r(80298);Object.defineProperty(t,"UnionType",{enumerable:!0,get:function(){return p.UnionType}})},4835:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.JsonType=t.JsonPrimitiveType=t.JsonArrayType=t.JsonObjectType=void 0;let n=r(25020),i=r(34405);function o(e){return null===e||"string"==typeof e||"boolean"==typeof e||"number"==typeof e}function s(e){return"[object Object]"===Object.prototype.toString.call(e)}function a(e){return Array.isArray(e)&&e.every(c)}function u(e){return s(e)&&Object.values(e).every(c)}function c(e){return o(e)||a(e)||u(e)}class l{constructor(e={}){this.definition=e}getTypes(){return["object"]}isValidType(e){return s(e)}validate(e,t=[]){if(!u(e))throw new n.Violation(`Expected a JSON object at path '${(0,i.formatPath)(t)}', actual ${(0,i.describe)(e)}.`,t,{type:"object"});if(void 0!==this.definition.properties||void 0!==this.definition.propertyNames)for(let[r,n]of Object.entries(e)){let e=t.concat([r]);void 0!==this.definition.propertyNames&&this.definition.propertyNames.validate(r,e),void 0!==this.definition.properties&&this.definition.properties.validate(n,t.concat([r]))}}}t.JsonObjectType=l;class d{constructor(e={}){this.definition=e}getTypes(){return["array"]}isValidType(e){return Array.isArray(e)}validate(e,t=[]){if(!a(e))throw new n.Violation(`Expected a JSON array at path '${(0,i.formatPath)(t)}', actual ${(0,i.describe)(e)}.`,t,{type:"array"});if(void 0!==this.definition.items)for(let r=0;r<e.length;r++)this.definition.items.validate(e[r],t.concat([r.toString()]))}}t.JsonArrayType=d;class h{getTypes(){return["null","number","string","boolean"]}isValidType(e){return o(e)}validate(e,t=[]){if(!this.isValidType(e))throw new n.Violation(`Expected a JSON primitive at path '${(0,i.formatPath)(t)}', actual ${(0,i.describe)(e)}.`,t,{type:this.getTypes().join("|")})}}t.JsonPrimitiveType=h;class p{getTypes(){return["null","number","string","boolean","array","object"]}isValidType(e){return o(e)||Array.isArray(e)||s(e)}validate(e,t=[]){if(!c(e))throw new n.Violation(`Expected a JSON value at path '${(0,i.formatPath)(t)}', actual ${(0,i.describe)(e)}.`,t,{type:this.getTypes().join("|")})}}t.JsonType=p},38088:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MixedSchema=void 0;class r{validate(){}}t.MixedSchema=r},74578:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NullType=void 0;let n=r(25020),i=r(34405);class o{getTypes(){return["null"]}isValidType(e){return null===e}validate(e,t=[]){if(!this.isValidType(e))throw new n.Violation(`Expected value of type null at path '${(0,i.formatPath)(t)}', actual ${(0,i.describe)(e)}.`,t,{type:"null"})}}t.NullType=o},71759:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NumberType=void 0;let n=r(25020),i=r(34405);class o{constructor(e={}){var t,r,n;this.definition={...e,integer:null!==(t=e.integer)&&void 0!==t&&t,minimum:null!==(r=e.minimum)&&void 0!==r?r:Number.NEGATIVE_INFINITY,maximum:null!==(n=e.maximum)&&void 0!==n?n:Number.POSITIVE_INFINITY}}getTypes(){return[this.definition.integer?"integer":"number"]}isValidType(e){return"number"==typeof e&&(!this.definition.integer||Number.isInteger(e))}validate(e,t=[]){if(!this.isValidType(e)){let r=this.getTypes()[0];throw new n.Violation(`Expected value of type ${r} at path '${(0,i.formatPath)(t)}', actual ${(0,i.describe)(e)}.`,t,{type:r})}if(e<this.definition.minimum)throw new n.Violation(`Expected a value greater than or equal to ${this.definition.minimum} at path '${(0,i.formatPath)(t)}', actual ${e}.`,t,{limit:this.definition.minimum});if(e>this.definition.maximum)throw new n.Violation(`Expected a value less than or equal to ${this.definition.maximum} at path '${(0,i.formatPath)(t)}', actual ${e}.`,t,{limit:this.definition.maximum})}}t.NumberType=o},69789:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ObjectType=void 0;let n=r(25020),i=r(38088),o=r(34405);class s{constructor(e={}){var t,r,n,o,s,a;this.definition={...e,properties:null!==(t=e.properties)&&void 0!==t?t:{},required:null!==(r=e.required)&&void 0!==r?r:[],additionalProperties:null!==(n=e.additionalProperties)&&void 0!==n&&n,propertyNames:null!==(o=e.propertyNames)&&void 0!==o?o:new i.MixedSchema,minProperties:null!==(s=e.minProperties)&&void 0!==s?s:-1,maxProperties:null!==(a=e.maxProperties)&&void 0!==a?a:-1}}getTypes(){return void 0!==this.definition.type?[this.definition.type.name]:["object"]}isValidType(e){return void 0!==this.definition.type?e instanceof this.definition.type:"[object Object]"===Object.prototype.toString.call(e)}validate(e,t=[]){if(!this.isValidType(e)){let[r]=this.getTypes();throw new n.Violation(`Expected value of type ${r} at path '${(0,o.formatPath)(t)}', actual ${(0,o.describe)(e)}.`,t,{type:r})}let r=Object.entries(e),{minProperties:i,maxProperties:s}=this.definition;if(i>=0&&i>r.length)throw new n.Violation(`Expected ${i===s?"exactly":"at least"} ${i} ${1===i?"entry":"entries"} at path '${(0,o.formatPath)(t)}', actual ${r.length}.`,t,{limit:i});if(s>=0&&s<r.length)throw new n.Violation(`Expected ${i===s?"exactly":"at most"} ${s} ${1===s?"entry":"entries"} at path '${(0,o.formatPath)(t)}', actual ${r.length}.`,t,{limit:s});let a={...e};for(let r of this.definition.required)if(!(r in e))throw new n.Violation(`Missing property '${(0,o.formatPath)(t.concat([r]))}'.`,t,{required:r});for(let[e,i]of r){let r=t.concat([e]);this.definition.propertyNames.validate(e,r);let s=this.definition.properties[e];if(void 0!==s){s.validate(i,r),delete a[e];continue}if(!1===this.definition.additionalProperties)throw new n.Violation(`Unknown property '${(0,o.formatPath)(r)}'.`,r,{additionalProperty:e});!0!==this.definition.additionalProperties&&this.definition.additionalProperties.validate(i,r)}let{subtypes:u}=this.definition;if(void 0!==u){let r=e[u.discriminator];void 0!==r&&void 0!==u.schemas[r]&&u.schemas[r].validate(a,t)}}}t.ObjectType=s},25020:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Violation=void 0;class r extends Error{constructor(e,t,r){super(e),this.path=t,this.params=r}}t.Violation=r},79595:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StringType=void 0;let n=r(25020),i=r(34405),o={pointer:function(e){return/^(\.|([a-zA-Z_][a-zA-Z0-9_]*|\[[0-9]+])(\.[a-zA-Z_][a-zA-Z0-9_]*|\[[0-9]+])*)$/.test(e)},identifier:function(e){return/^[a-zA-Z_][a-zA-Z0-9_]*$/.test(e)},uuid:function(e){return/^[0-9a-f]{8}-(?:[0-9a-f]{4}-){3}[0-9a-f]{12}$/.test(e)},date:function(e){return/^(\d\d\d\d)-(\d\d)-(\d\d)$/.test(e)},url:function(e){try{new URL(e)}catch{return!1}return!0}};class s{constructor(e={}){var t,r,n;this.definition={...e,minLength:null!==(t=e.minLength)&&void 0!==t?t:-1,maxLength:null!==(r=e.maxLength)&&void 0!==r?r:-1,enumeration:null!==(n=e.enumeration)&&void 0!==n?n:[]}}getTypes(){return["string"]}isValidType(e){return"string"==typeof e}validate(e,t=[]){if(!this.isValidType(e))throw new n.Violation(`Expected value of type string at path '${(0,i.formatPath)(t)}', actual ${(0,i.describe)(e)}.`,t,{type:"string"});let{minLength:r,maxLength:s}=this.definition;if(r>=0&&r>e.length)throw new n.Violation(`Expected ${r===s?"exactly":"at least"} ${r} ${1===r?"character":"characters"} at path '${(0,i.formatPath)(t)}', actual ${e.length}.`,t,{limit:r});if(s>=0&&s<e.length)throw new n.Violation(`Expected ${r===s?"exactly":"at most"} ${s} ${1===s?"character":"characters"} at path '${(0,i.formatPath)(t)}', actual ${e.length}.`,t,{limit:s});let{enumeration:a}=this.definition;if(a.length>0&&0>a.indexOf(e))throw new n.Violation(`Unexpected value at path '${(0,i.formatPath)(t)}', expecting '${1===a.length?a[0]:`${a.slice(0,-1).join("', '")}' or '${a.slice(-1)}`}', found '${e}'.`,t,{enumeration:a});let{format:u,pattern:c}=this.definition;if(void 0!==u&&!o[u](e))throw new n.Violation(`Invalid ${u} format at path '${(0,i.formatPath)(t)}'.`,t,{format:u});if(void 0!==c&&!c.test(e))throw new n.Violation(`Invalid format at path '${(0,i.formatPath)(t)}'.`,t,{pattern:c})}}t.StringType=s},80298:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UnionType=void 0;let n=r(25020),i=r(34405);class o{constructor(e,t,...r){this.schemas=[e,t,...r]}getTypes(){let e=[];for(let t of this.schemas)for(let r of t.getTypes())0>e.indexOf(r)&&e.push(r);return e}isValidType(e){for(let t of this.schemas)if(t.isValidType(e))return!0;return!1}validate(e,t=[]){for(let r of this.schemas)if(r.isValidType(e)){r.validate(e,t);return}let r=this.getTypes();throw new n.Violation(`Expected value of type ${r.slice(0,-1).join(", ")} or ${r[r.length-1]} at path '${(0,i.formatPath)(t)}', actual ${(0,i.describe)(e)}.`,t,{type:r.join("|")})}}t.UnionType=o},34405:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.describe=function(e){return null===e?"null":Array.isArray(e)?"array":"number"==typeof e?Number.isInteger(e)?"integer":"number":"object"==typeof e?e.constructor.name:typeof e},t.formatPath=function(e){return`/${e.join("/")}`}},62601:function(e,t,r){"use strict";var n,i;e.exports=(null==(n=r.g.process)?void 0:n.env)&&"object"==typeof(null==(i=r.g.process)?void 0:i.env)?r.g.process:r(58960)},58960:function(e){!function(){var t={229:function(e){var t,r,n,i=e.exports={};function o(){throw Error("setTimeout has not been defined")}function s(){throw Error("clearTimeout has not been defined")}function a(e){if(t===setTimeout)return setTimeout(e,0);if((t===o||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(r){try{return t.call(null,e,0)}catch(r){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:o}catch(e){t=o}try{r="function"==typeof clearTimeout?clearTimeout:s}catch(e){r=s}}();var u=[],c=!1,l=-1;function d(){c&&n&&(c=!1,n.length?u=n.concat(u):l=-1,u.length&&h())}function h(){if(!c){var e=a(d);c=!0;for(var t=u.length;t;){for(n=u,u=[];++l<t;)n&&n[l].run();l=-1,t=u.length}n=null,c=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===s||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function p(e,t){this.fun=e,this.array=t}function f(){}i.nextTick=function(e){var t=Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];u.push(new p(e,t)),1!==u.length||c||a(h)},p.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=f,i.addListener=f,i.once=f,i.off=f,i.removeListener=f,i.removeAllListeners=f,i.emit=f,i.prependListener=f,i.prependOnceListener=f,i.listeners=function(e){return[]},i.binding=function(e){throw Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw Error("process.chdir is not supported")},i.umask=function(){return 0}}},r={};function n(e){var i=r[e];if(void 0!==i)return i.exports;var o=r[e]={exports:{}},s=!0;try{t[e](o,o.exports,n),s=!1}finally{s&&delete r[e]}return o.exports}n.ab="//";var i=n(229);e.exports=i}()},30622:function(e,t,r){"use strict";var n=r(2265),i=Symbol.for("react.element"),o=Symbol.for("react.fragment"),s=Object.prototype.hasOwnProperty,a=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,u={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,r){var n,o={},c=null,l=null;for(n in void 0!==r&&(c=""+r),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(l=t.ref),t)s.call(t,n)&&!u.hasOwnProperty(n)&&(o[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps)void 0===o[n]&&(o[n]=t[n]);return{$$typeof:i,type:e,key:c,ref:l,props:o,_owner:a.current}}t.Fragment=o,t.jsx=c,t.jsxs=c},57437:function(e,t,r){"use strict";e.exports=r(30622)},8687:function(e,t,r){"use strict";r.r(t),r.d(t,{__addDisposableResource:function(){return N},__assign:function(){return o},__asyncDelegator:function(){return P},__asyncGenerator:function(){return _},__asyncValues:function(){return O},__await:function(){return S},__awaiter:function(){return f},__classPrivateFieldGet:function(){return L},__classPrivateFieldIn:function(){return M},__classPrivateFieldSet:function(){return I},__createBinding:function(){return y},__decorate:function(){return a},__disposeResources:function(){return $},__esDecorate:function(){return c},__exportStar:function(){return m},__extends:function(){return i},__generator:function(){return g},__importDefault:function(){return x},__importStar:function(){return j},__makeTemplateObject:function(){return E},__metadata:function(){return p},__param:function(){return u},__propKey:function(){return d},__read:function(){return b},__rest:function(){return s},__rewriteRelativeImportExtension:function(){return R},__runInitializers:function(){return l},__setFunctionName:function(){return h},__spread:function(){return w},__spreadArray:function(){return k},__spreadArrays:function(){return T},__values:function(){return v}});var n=function(e,t){return(n=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)};function i(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var o=function(){return(o=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function s(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&0>t.indexOf(n)&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)0>t.indexOf(n[i])&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]]);return r}function a(e,t,r,n){var i,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,r,s):i(t,r))||s);return o>3&&s&&Object.defineProperty(t,r,s),s}function u(e,t){return function(r,n){t(r,n,e)}}function c(e,t,r,n,i,o){function s(e){if(void 0!==e&&"function"!=typeof e)throw TypeError("Function expected");return e}for(var a,u=n.kind,c="getter"===u?"get":"setter"===u?"set":"value",l=!t&&e?n.static?e:e.prototype:null,d=t||(l?Object.getOwnPropertyDescriptor(l,n.name):{}),h=!1,p=r.length-1;p>=0;p--){var f={};for(var g in n)f[g]="access"===g?{}:n[g];for(var g in n.access)f.access[g]=n.access[g];f.addInitializer=function(e){if(h)throw TypeError("Cannot add initializers after decoration has completed");o.push(s(e||null))};var y=(0,r[p])("accessor"===u?{get:d.get,set:d.set}:d[c],f);if("accessor"===u){if(void 0===y)continue;if(null===y||"object"!=typeof y)throw TypeError("Object expected");(a=s(y.get))&&(d.get=a),(a=s(y.set))&&(d.set=a),(a=s(y.init))&&i.unshift(a)}else(a=s(y))&&("field"===u?i.unshift(a):d[c]=a)}l&&Object.defineProperty(l,n.name,d),h=!0}function l(e,t,r){for(var n=arguments.length>2,i=0;i<t.length;i++)r=n?t[i].call(e,r):t[i].call(e);return n?r:void 0}function d(e){return"symbol"==typeof e?e:"".concat(e)}function h(e,t,r){return"symbol"==typeof t&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:r?"".concat(r," ",t):t})}function p(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function f(e,t,r,n){return new(r||(r=Promise))(function(i,o){function s(e){try{u(n.next(e))}catch(e){o(e)}}function a(e){try{u(n.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):((t=e.value)instanceof r?t:new r(function(e){e(t)})).then(s,a)}u((n=n.apply(e,t||[])).next())})}function g(e,t){var r,n,i,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]},s=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return s.next=a(0),s.throw=a(1),s.return=a(2),"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(a){return function(u){return function(a){if(r)throw TypeError("Generator is already executing.");for(;s&&(s=0,a[0]&&(o=0)),o;)try{if(r=1,n&&(i=2&a[0]?n.return:a[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,a[1])).done)return i;switch(n=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,n=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(6===a[0]||2===a[0])){o=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){o.label=a[1];break}if(6===a[0]&&o.label<i[1]){o.label=i[1],i=a;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(a);break}i[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(e){a=[6,e],n=0}finally{r=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,u])}}}var y=Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]};function m(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||y(t,e,r)}function v(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function b(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,i,o=r.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(n=o.next()).done;)s.push(n.value)}catch(e){i={error:e}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(i)throw i.error}}return s}function w(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(b(arguments[t]));return e}function T(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;for(var n=Array(e),i=0,t=0;t<r;t++)for(var o=arguments[t],s=0,a=o.length;s<a;s++,i++)n[i]=o[s];return n}function k(e,t,r){if(r||2==arguments.length)for(var n,i=0,o=t.length;i<o;i++)!n&&i in t||(n||(n=Array.prototype.slice.call(t,0,i)),n[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))}function S(e){return this instanceof S?(this.v=e,this):new S(e)}function _(e,t,r){if(!Symbol.asyncIterator)throw TypeError("Symbol.asyncIterator is not defined.");var n,i=r.apply(e,t||[]),o=[];return n=Object.create(("function"==typeof AsyncIterator?AsyncIterator:Object).prototype),s("next"),s("throw"),s("return",function(e){return function(t){return Promise.resolve(t).then(e,c)}}),n[Symbol.asyncIterator]=function(){return this},n;function s(e,t){i[e]&&(n[e]=function(t){return new Promise(function(r,n){o.push([e,t,r,n])>1||a(e,t)})},t&&(n[e]=t(n[e])))}function a(e,t){try{var r;(r=i[e](t)).value instanceof S?Promise.resolve(r.value.v).then(u,c):l(o[0][2],r)}catch(e){l(o[0][3],e)}}function u(e){a("next",e)}function c(e){a("throw",e)}function l(e,t){e(t),o.shift(),o.length&&a(o[0][0],o[0][1])}}function P(e){var t,r;return t={},n("next"),n("throw",function(e){throw e}),n("return"),t[Symbol.iterator]=function(){return this},t;function n(n,i){t[n]=e[n]?function(t){return(r=!r)?{value:S(e[n](t)),done:!1}:i?i(t):t}:i}}function O(e){if(!Symbol.asyncIterator)throw TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=v(e),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(r){t[r]=e[r]&&function(t){return new Promise(function(n,i){!function(e,t,r,n){Promise.resolve(n).then(function(t){e({value:t,done:r})},t)}(n,i,(t=e[r](t)).done,t.value)})}}}function E(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var C=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t};function j(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&y(t,e,r);return C(t,e),t}function x(e){return e&&e.__esModule?e:{default:e}}function L(e,t,r,n){if("a"===r&&!n)throw TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)}function I(e,t,r,n,i){if("m"===n)throw TypeError("Private method is not writable");if("a"===n&&!i)throw TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!i:!t.has(e))throw TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?i.call(e,r):i?i.value=r:t.set(e,r),r}function M(e,t){if(null===t||"object"!=typeof t&&"function"!=typeof t)throw TypeError("Cannot use 'in' operator on non-object");return"function"==typeof e?t===e:e.has(t)}function N(e,t,r){if(null!=t){var n,i;if("object"!=typeof t&&"function"!=typeof t)throw TypeError("Object expected.");if(r){if(!Symbol.asyncDispose)throw TypeError("Symbol.asyncDispose is not defined.");n=t[Symbol.asyncDispose]}if(void 0===n){if(!Symbol.dispose)throw TypeError("Symbol.dispose is not defined.");n=t[Symbol.dispose],r&&(i=n)}if("function"!=typeof n)throw TypeError("Object not disposable.");i&&(n=function(){try{i.call(this)}catch(e){return Promise.reject(e)}}),e.stack.push({value:t,dispose:n,async:r})}else r&&e.stack.push({async:!0});return t}var A="function"==typeof SuppressedError?SuppressedError:function(e,t,r){var n=Error(r);return n.name="SuppressedError",n.error=e,n.suppressed=t,n};function $(e){function t(t){e.error=e.hasError?new A(t,e.error,"An error was suppressed during disposal."):t,e.hasError=!0}var r,n=0;return function i(){for(;r=e.stack.pop();)try{if(!r.async&&1===n)return n=0,e.stack.push(r),Promise.resolve().then(i);if(r.dispose){var o=r.dispose.call(r.value);if(r.async)return n|=2,Promise.resolve(o).then(i,function(e){return t(e),i()})}else n|=1}catch(e){t(e)}if(1===n)return e.hasError?Promise.reject(e.error):Promise.resolve();if(e.hasError)throw e.error}()}function R(e,t){return"string"==typeof e&&/^\.\.?\//.test(e)?e.replace(/\.(tsx)$|((?:\.d)?)((?:\.[^./]+?)?)\.([cm]?)ts$/i,function(e,r,n,i,o){return r?t?".jsx":".js":!n||i&&o?n+i+"."+o.toLowerCase()+"js":e}):e}t.default={__extends:i,__assign:o,__rest:s,__decorate:a,__param:u,__esDecorate:c,__runInitializers:l,__propKey:d,__setFunctionName:h,__metadata:p,__awaiter:f,__generator:g,__createBinding:y,__exportStar:m,__values:v,__read:b,__spread:w,__spreadArrays:T,__spreadArray:k,__await:S,__asyncGenerator:_,__asyncDelegator:P,__asyncValues:O,__makeTemplateObject:E,__importStar:j,__importDefault:x,__classPrivateFieldGet:L,__classPrivateFieldSet:I,__classPrivateFieldIn:M,__addDisposableResource:N,__disposeResources:$,__rewriteRelativeImportExtension:R}},99094:function(e,t,r){"use strict";r.r(t),r.d(t,{__addDisposableResource:function(){return N},__assign:function(){return o},__asyncDelegator:function(){return P},__asyncGenerator:function(){return _},__asyncValues:function(){return O},__await:function(){return S},__awaiter:function(){return f},__classPrivateFieldGet:function(){return L},__classPrivateFieldIn:function(){return M},__classPrivateFieldSet:function(){return I},__createBinding:function(){return y},__decorate:function(){return a},__disposeResources:function(){return $},__esDecorate:function(){return c},__exportStar:function(){return m},__extends:function(){return i},__generator:function(){return g},__importDefault:function(){return x},__importStar:function(){return j},__makeTemplateObject:function(){return E},__metadata:function(){return p},__param:function(){return u},__propKey:function(){return d},__read:function(){return b},__rest:function(){return s},__runInitializers:function(){return l},__setFunctionName:function(){return h},__spread:function(){return w},__spreadArray:function(){return k},__spreadArrays:function(){return T},__values:function(){return v}});var n=function(e,t){return(n=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)};function i(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var o=function(){return(o=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function s(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&0>t.indexOf(n)&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)0>t.indexOf(n[i])&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]]);return r}function a(e,t,r,n){var i,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,r,s):i(t,r))||s);return o>3&&s&&Object.defineProperty(t,r,s),s}function u(e,t){return function(r,n){t(r,n,e)}}function c(e,t,r,n,i,o){function s(e){if(void 0!==e&&"function"!=typeof e)throw TypeError("Function expected");return e}for(var a,u=n.kind,c="getter"===u?"get":"setter"===u?"set":"value",l=!t&&e?n.static?e:e.prototype:null,d=t||(l?Object.getOwnPropertyDescriptor(l,n.name):{}),h=!1,p=r.length-1;p>=0;p--){var f={};for(var g in n)f[g]="access"===g?{}:n[g];for(var g in n.access)f.access[g]=n.access[g];f.addInitializer=function(e){if(h)throw TypeError("Cannot add initializers after decoration has completed");o.push(s(e||null))};var y=(0,r[p])("accessor"===u?{get:d.get,set:d.set}:d[c],f);if("accessor"===u){if(void 0===y)continue;if(null===y||"object"!=typeof y)throw TypeError("Object expected");(a=s(y.get))&&(d.get=a),(a=s(y.set))&&(d.set=a),(a=s(y.init))&&i.unshift(a)}else(a=s(y))&&("field"===u?i.unshift(a):d[c]=a)}l&&Object.defineProperty(l,n.name,d),h=!0}function l(e,t,r){for(var n=arguments.length>2,i=0;i<t.length;i++)r=n?t[i].call(e,r):t[i].call(e);return n?r:void 0}function d(e){return"symbol"==typeof e?e:"".concat(e)}function h(e,t,r){return"symbol"==typeof t&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:r?"".concat(r," ",t):t})}function p(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function f(e,t,r,n){return new(r||(r=Promise))(function(i,o){function s(e){try{u(n.next(e))}catch(e){o(e)}}function a(e){try{u(n.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):((t=e.value)instanceof r?t:new r(function(e){e(t)})).then(s,a)}u((n=n.apply(e,t||[])).next())})}function g(e,t){var r,n,i,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]},s=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return s.next=a(0),s.throw=a(1),s.return=a(2),"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(a){return function(u){return function(a){if(r)throw TypeError("Generator is already executing.");for(;s&&(s=0,a[0]&&(o=0)),o;)try{if(r=1,n&&(i=2&a[0]?n.return:a[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,a[1])).done)return i;switch(n=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,n=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(6===a[0]||2===a[0])){o=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){o.label=a[1];break}if(6===a[0]&&o.label<i[1]){o.label=i[1],i=a;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(a);break}i[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(e){a=[6,e],n=0}finally{r=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,u])}}}var y=Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]};function m(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||y(t,e,r)}function v(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function b(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,i,o=r.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(n=o.next()).done;)s.push(n.value)}catch(e){i={error:e}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(i)throw i.error}}return s}function w(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(b(arguments[t]));return e}function T(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;for(var n=Array(e),i=0,t=0;t<r;t++)for(var o=arguments[t],s=0,a=o.length;s<a;s++,i++)n[i]=o[s];return n}function k(e,t,r){if(r||2==arguments.length)for(var n,i=0,o=t.length;i<o;i++)!n&&i in t||(n||(n=Array.prototype.slice.call(t,0,i)),n[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))}function S(e){return this instanceof S?(this.v=e,this):new S(e)}function _(e,t,r){if(!Symbol.asyncIterator)throw TypeError("Symbol.asyncIterator is not defined.");var n,i=r.apply(e,t||[]),o=[];return n=Object.create(("function"==typeof AsyncIterator?AsyncIterator:Object).prototype),s("next"),s("throw"),s("return",function(e){return function(t){return Promise.resolve(t).then(e,c)}}),n[Symbol.asyncIterator]=function(){return this},n;function s(e,t){i[e]&&(n[e]=function(t){return new Promise(function(r,n){o.push([e,t,r,n])>1||a(e,t)})},t&&(n[e]=t(n[e])))}function a(e,t){try{var r;(r=i[e](t)).value instanceof S?Promise.resolve(r.value.v).then(u,c):l(o[0][2],r)}catch(e){l(o[0][3],e)}}function u(e){a("next",e)}function c(e){a("throw",e)}function l(e,t){e(t),o.shift(),o.length&&a(o[0][0],o[0][1])}}function P(e){var t,r;return t={},n("next"),n("throw",function(e){throw e}),n("return"),t[Symbol.iterator]=function(){return this},t;function n(n,i){t[n]=e[n]?function(t){return(r=!r)?{value:S(e[n](t)),done:!1}:i?i(t):t}:i}}function O(e){if(!Symbol.asyncIterator)throw TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=v(e),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(r){t[r]=e[r]&&function(t){return new Promise(function(n,i){!function(e,t,r,n){Promise.resolve(n).then(function(t){e({value:t,done:r})},t)}(n,i,(t=e[r](t)).done,t.value)})}}}function E(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var C=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t};function j(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&y(t,e,r);return C(t,e),t}function x(e){return e&&e.__esModule?e:{default:e}}function L(e,t,r,n){if("a"===r&&!n)throw TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)}function I(e,t,r,n,i){if("m"===n)throw TypeError("Private method is not writable");if("a"===n&&!i)throw TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!i:!t.has(e))throw TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?i.call(e,r):i?i.value=r:t.set(e,r),r}function M(e,t){if(null===t||"object"!=typeof t&&"function"!=typeof t)throw TypeError("Cannot use 'in' operator on non-object");return"function"==typeof e?t===e:e.has(t)}function N(e,t,r){if(null!=t){var n,i;if("object"!=typeof t&&"function"!=typeof t)throw TypeError("Object expected.");if(r){if(!Symbol.asyncDispose)throw TypeError("Symbol.asyncDispose is not defined.");n=t[Symbol.asyncDispose]}if(void 0===n){if(!Symbol.dispose)throw TypeError("Symbol.dispose is not defined.");n=t[Symbol.dispose],r&&(i=n)}if("function"!=typeof n)throw TypeError("Object not disposable.");i&&(n=function(){try{i.call(this)}catch(e){return Promise.reject(e)}}),e.stack.push({value:t,dispose:n,async:r})}else r&&e.stack.push({async:!0});return t}var A="function"==typeof SuppressedError?SuppressedError:function(e,t,r){var n=Error(r);return n.name="SuppressedError",n.error=e,n.suppressed=t,n};function $(e){function t(t){e.error=e.hasError?new A(t,e.error,"An error was suppressed during disposal."):t,e.hasError=!0}var r,n=0;return function i(){for(;r=e.stack.pop();)try{if(!r.async&&1===n)return n=0,e.stack.push(r),Promise.resolve().then(i);if(r.dispose){var o=r.dispose.call(r.value);if(r.async)return n|=2,Promise.resolve(o).then(i,function(e){return t(e),i()})}else n|=1}catch(e){t(e)}if(1===n)return e.hasError?Promise.reject(e.error):Promise.resolve();if(e.hasError)throw e.error}()}t.default={__extends:i,__assign:o,__rest:s,__decorate:a,__param:u,__metadata:p,__awaiter:f,__generator:g,__createBinding:y,__exportStar:m,__values:v,__read:b,__spread:w,__spreadArrays:T,__spreadArray:k,__await:S,__asyncGenerator:_,__asyncDelegator:P,__asyncValues:O,__makeTemplateObject:E,__importStar:j,__importDefault:x,__classPrivateFieldGet:L,__classPrivateFieldSet:I,__classPrivateFieldIn:M,__addDisposableResource:N,__disposeResources:$}}}]);